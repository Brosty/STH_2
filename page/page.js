!function(E){"use strict";const D="itemGI",H="itemIGI",N="itemHN",q="itemUC",G="name",c="quantity",Q="open",h="market_hash_name",U="url",_="appid",V="filter",z="sort",d="groupID",J="name";const W="item_nameid",o="buy_type",Y="contextid",s="b_cnt",X="b_min",K="b_summ",Z="b_on",tt="s_on",nt="s_summ",r="publisher_fee_percent",et="min_float",it="max_float",at="fon";var ot,rt,ct;{var n=E,st,ut=n,i=null;async function u(){var e;return null===i&&(e=async function(){null===i&&((i=await new Promise(i=>{const a=ut[Qn].open(qn,Gn);let o=null;a.onerror=()=>{throw new Error("Why didn't you allow my web app to use IndexedDB?!")},a.onsuccess=t=>{o=t.target.result,i(o)},a.onupgradeneeded=async t=>{switch(o=a.result,t.oldVersion){case 0:case 1:await ft(e=o,Hn,[n(Pn,G,{multiEntry:!1}),n(Ln,c,{multiEntry:!1})]),await ft(e,M,[n(Rn,Y,{multiEntry:!1}),n(Mn,_,{multiEntry:!1}),n(I,Z,{multiEntry:!1}),n(Dn,[Z,at],{multiEntry:!1}),n(P,tt,{multiEntry:!1}),n(L,d,{multiEntry:!1}),n(En,h,{unique:!0,multiEntry:!1})]),await ft(e,Nn,[n(In,"name",{unique:!0,multiEntry:!1})])}function n(t,n,e){return{[ot]:t,[rt]:n,[ct]:e}}var e,t=t.target.transaction;if(null===t)throw new Error("Error IndexedDB init db");t.oncomplete=function(){if(null===o)throw new Error("Can`t init DB");i(o)}}})).onclose=function(){i=null})},await new Promise(function(t){async function n(){try{st=!0,t(await e())}finally{st=!1}}!function t(){!0===st?setTimeout(t,100):n()}()})),i}function lt(){return{name:"New group",[Q]:!0,type:0,[c]:0,sort:0}}const In="a_n",Pn="g_name",Ln="g_q",Rn="i_c_id",Mn="i_a",I="i_B",P="i_S",L="i_gId",En="i_hn",Dn="i_B2",Fn="readonly",R="readwrite",M="item",Hn="group",Nn="accounts",qn="STH",Gn=1,Qn="indexedDB";function dt(t){throw new Error("Error init IndexedDB?!")}function ft(e,i,a){return new Promise(t=>{const n=e.createObjectStore(i,{keyPath:"id",autoIncrement:!0});void 0!==a&&a.forEach(t=>{n.createIndex(t[ot],t[rt],t[ct])}),n.transaction.onerror=dt,n.transaction.oncomplete=function(t){},t(void 0)})}function pt(t){var n=t[V]||0<t[et]||0!==t[it]&&t[it]<1;return t[at]=1!==t[o]&&n?1:0,t}function ht(){return{fon:0,[z]:0,[d]:0,name:"",contextid:0,b_on:0,b_cnt:0,b_min:0,b_summ:0,s_on:0,s_summ:0,min_float:0,max_float:0}}function _t(n,c,t,e,a){var s=!1;async function o(t){t=(await n()).transaction(c,t||Fn);return t.onerror=t=>{throw new Error("Transaction "+c+" error:"+t)},t}async function u(t){return(await o(t)).objectStore(c)}function l(){return new Promise(function(n){!function t(){!0===s?setTimeout(t,5):n()}()})}function d(e){return new Promise(async function(t){const n=(await u()).getAll(e);n.onerror=function(){throw new Error("Query "+c+" error")},n.onsuccess=()=>{t(n.result)}})}function f(a){return new Promise(async function(n){const e=await u(),i=[];a.forEach(t=>{t=e.get(t);t.onerror=function(){throw new Error("Query "+c+" error")},t.onsuccess=t=>{i.push(t.target.result),i.length===a.length&&n(i)}})})}return{lock:function(e){return new Promise(function(t){async function n(){try{s=!0,t(await e())}finally{s=!1}}!function t(){!0===s?setTimeout(t,5):n()}()})},set:function(i){return!i.id&&a&&(i=Object.assign(a(),i)),t&&(i=t(i)),new Promise(async function(n){var t=await o(R);t.onerror=function(){throw new Error("set "+c+" error")};var e=t.objectStore(c).put(i);e.onerror=function(){throw new Error("set "+c+" error")},e.onsuccess=function(t){n(t.target.result)},t.commit()})},up:async function(t,n){try{await l(),s=!0;var e=Array.isArray(t)?await f(t):await d(t),i=[];for(const c in e){var a=e[c].id,o=Object.assign(e[c],n),r=(o.id=a,await this.set(o));o.id=r,i.push(r)}return i}finally{s=!1}},c:async function(){try{await l(),s=!0,await(await u(R)).clear()}finally{s=!1}},rm:async function(i){Array.isArray(i)||(i=[i]);try{await l(),s=!0;const t=await o(R),a=t.objectStore(c);await new Promise(function(n){let e=0;i.forEach(t=>{a.delete(t).onsuccess=function(){++e===i.length&&n()}}),t.commit()})}finally{s=!1}},getIdsByIndex:async function(i,a){const o=await n();return new Promise(n=>{var t=o.transaction(c,Fn);const e=(void 0!==a?t.objectStore(c).index(a):t.objectStore(c)).getAllKeys(i);e.onerror=function(){throw new Error("Query "+c+" error")},e.onsuccess=t=>{n(e.result)}})},get:async function(t,n){var i,a;return void 0!==n?(i=t,a=n,new Promise(async function(n){const e=(await u()).index(a).getAll(i);e.onerror=function(){throw new Error("Query "+c+" error")},e.onsuccess=t=>{n(e.result)}})):(Array.isArray(t)?f:d)(t)},cnt:function(a,o){return new Promise(async function(n,t){var e=await u();const i=(o?e.index(o):e).count(a);i.onerror=t,i.onsuccess=t=>{n(i.result)}})},getOne:async function(t,n){t=await this.get(t,n);return 0!==t.length?t[0]:null},for:function(e,i){let a=0;return new Promise(async function(n){e.forEach(async t=>{(await u()).get(t).onsuccess=t=>{a++,void 0!==t.target.result&&i(t.target.result),a===e.length&&n()}})})},forQ:function(n,a,o,r){return new Promise(async function(e,t){const i=(await u()).index(a).openCursor(n,r?"nextunique":void 0);i.onerror=function(){t(new Error("forQ "+c+" error"))},i.onsuccess=t=>{var n=i.result;n?(o(n.value,n.key),n.continue()):e(null)}})}}}n[Qn]?n.DB||(n.DB=function(){u();function t(){}const i=_t(u,Hn,void 0,0,lt),a=function(t){var n=_t(u,M,pt,0,ht);return t[M]=n,function(t,i){t[N]=function(t){return i.getOne(t,En)},t[D]=function(t){return i.get(t,L)},t[H]=function(t){return i.getIdsByIndex(t,L)},t.getIBOn=function(){return i.get(!0,I)},t.getItemWithEmpty=function(){return i.getIdsByIndex(0,Rn)},t.adata=async function(){const n={};return await i.forQ(1,P,function(t){n[t[_]]||(n[t[_]]={}),n[t[_]][t[Y]]=!0}),n},t.aurl=function(t){i.forQ(void 0,Mn,t,!0)},t.bOnCnt=function(){return i.cnt(1,I)},t.getItemIdsWithOnFilters=function(){return i.getIdsByIndex([1,1],Dn)},t.gIBIS=function(){return new Promise(function(t,n){const e=[];i.forQ(1,I,function(t){t[o]&&t[W]&&e.push(t.id)}).then(function(){t(e)}).catch(n)})},t.gISIS=function(){return new Promise(function(t,n){const e=[];i.forQ(1,P,function(t){t[o]&&t[W]&&e.push(t.id)}).then(function(){t(e)}).catch(n)})}}(t,n),function(t,i){t.itemUP=function(t,e){return i.getIdsByIndex(+t,Mn).then(function(t){for(var n=0;n<t.length;n++)i.up(t[n],{publisher_fee_percent:e})})},t[q]=function(a,o){return i.lock(async function(){return new Promise(async function(e,i){var t=(await u()).transaction(M,R),n=t.objectStore(M);t.onerror=function(){i(new Error(q+":"+M+" error"))},n.openCursor(a).onsuccess=function(t){t=t.target.result;if(t){const n=t.value;n[s]+=o;t=t.update(n);t.onreeor=function(){i(new Error(q+":"+M+" errorSave"))},t.onsuccess=function(){e(n)}}else e(null)}})})}}(t,n),n}(t),n=_t(u,Nn);return t[Hn]=i,t._item={c:async function(){return[]},get:async function(){return[]}},t[Nn]=n,t.gAN=function(t){return n.getOne(t,In)},t.getCtn=function(){return new Promise(async function(t){t({c:await a.cnt(),b:await a.cnt(1,I),s:await a.cnt(1,P)})})},t.isEmpty=function(t){return t&&0===t[Y]},t.gid=async function(){const n=await i.getIdsByIndex(),e=[];return await a.forQ(void 0,L,function(t,n){0!==n&&e.push(n)},!0),[n.filter(t=>!e.includes(t)),e.filter(t=>!n.includes(t)),e,n]},t}(),ot="name",rt="columns",ct="options"):n.alert("DB disabled or not support in current BROWSER!!")}var j=E,mt=j,f="STH_init",vt="STH_chk_group",l="STH_chk_item",gt="STH_chk_chenge",yt="STH_show_start",$t="STH_show_end",bt="STH_ITEMS_DEL",kt="STH_ITEMS_CLEAR",wt="STH_SCROLL_L";function Ct(n){j.DB.gid().then(function(t){0!==t[0].length?(j.DB.group.rm(t[0]).finally(n||function(){}),Xt(t[0]).remove()):n&&n(),0!==t[1].length&&t[1].forEach(t=>{j.DB[H](t).then(function(t){j.DB.item.up(t,{[d]:0})})})})}function xt(t,n){var e;e=function(){Ct(),k(t).remove(),x(bt,{id:t}),n&&n()},j.DB.item.rm(t).finally(e||function(){})}function St(i){$("#wOptChkSound").each(function(){var t=$(this),n=this.id,e="gray";t.on("click",limit(function(){t.toggleClass(e),i("data")[n]=t.hasClass(e)?"":"1"},300)),i("data")[n]&&t.removeClass(e)}),St=function(){}}function Tt(f){var p,o,r,s,t,n,c="#STH2\n",h=["Loading.."],e="A",u="C",l=e,i=(t=f,$(document).on("click",function(t){r&&!$(t.target).closest(".act__sell").length&&(t="act__sell__act",$("."+t).removeClass(t),r=!1)}),$("#wOptAutoConfirm"));function _(){f("ACT").setForm({})}function m(){B(k(h),_),f("ACT").open(a),l=e}function a(e,i){x(function(t,n){t?(p=null,B(p=w(1),_)):(B(p=y(n),_),k(h),e||v(n,C())),e&&(1==e?k(["Login in STH site"]):2!=e&&k(101==e?["Now authenticator used by another device.","Connect the authenticator on this devise?",$("<i>",{class:"btn js__conn",html:"<i>Connect</i>"}).click(function(){f("ACT").openC(a)})]:["Unknown error."])),"function"==typeof i&&i()})}function d(t){t={loginTxt:"Enter SMS for end auth Login: "+t?.login,login:{type:"hidden",value:t?.login},type:{type:"hidden",value:t?.type},sms:{placeholder:"SMS code"}};T(2)(t)}function v(t,n){t=t.find(function(t){return t.id==n})||t[0];t?f("ACT").setId(t.id,function(t,n){t?"relogin"==t&&n.text?g():k(t):n&&!Object.keys(n).length?f("ACT").getSG():"sms"===n?.do&&d(n)}):k(["Error 1001."])}function g(){var t=$('<i class="btn"><i>Re login</i></i>');k([t]),t.click(function(){x(function(t,n){if(t)return m();var e=C(),t=e&&n.find(function(t){return t&&t.id==e})||n[0],n={t_user:"login: "+t.name,user:{type:"hidden",value:t.name},pass:{type:"password",placeholder:"Password"}};T(1)(n)})})}function y(t){var n,e=w(3),i=e.find(".act__sell__title,.aut__logo").empty(),a=e.find(".act__sell__list__accs").empty(),o=e.find(".act__recovery__code").empty();return Array.isArray(t)&&(t.forEach(function(t){var n;a.append((n=t.id,t=t.name,$("<div>",{class:"act__sell__list__accs__item"}).append($("<span>",{class:"act__sell__list__accs__item__name",text:t,data:{id:n}}).click(r)).append($("<div>",{class:"act__sell__list__accs__item__del"}).append("[",$("<span>",{data:{id:n},text:"X"}).click(c),"]"))))}),t=(n=C())&&t.find(function(t){return t&&t.id==n})||t[0])&&(s=t.id,i.text(t.name),o.text(t.recovery)),e;function r(){var e=+$(this).data("id");x(function(t,n){t?m():v(n,e)})}function c(){var t=parseInt($(this).data("id"));j.DB.accounts.rm(t).finally(function(){m()})}}function b(t){l=u,(n=p)&&n.find(".act__confirmation").length||p.find(".aut__body").replaceWith(w(4).find(".aut__body"));var o=p.find(".act__confirmation").show().empty(),n=p.find(".aut__body__text").hide();return Array.isArray(t)?t.forEach(function(t){var n,e,i,a;o.append((n=t.id,e=t.key,i=t.title,a=t.receiving,t=t.icon,$("<div>",{class:"act__confirmation__item"}).append($("<div>",{class:"act__confirmation__item__ico"}).append($("<img>",{src:t})),$("<div>",{class:"act__confirmation__item__text"}).append($("<div>",{class:"act__confirmation__item__name",text:i}),$("<div>",{class:"act__confirmation__item__desc",text:a})),$("<div>",{class:"act__confirmation__item__acc"}).append($("<i>",{class:"ico del",data:{id:n,k:e}}).click(c)," ",$("<i>",{class:"btn js__item__ok",data:{id:n,k:e}}).append($("<i>",{text:"Confirm"})).click(r)))))}):void 0===t&&(o.hide(),n.show(),k(h)),p;function r(){e(this,!0)}function c(){e(this,!1)}function e(t,n){var t=$(t),e=t.data();f("ACT").doConf(e.id,e.k,n),t.closest(".act__confirmation__item").remove()}}function k(t){p&&p.find(".aut__stepMess_text").length||B(p=w(0),_),p.find(".aut__code,.act__confirmation").hide();var n=p.find(".aut__stepMess_text").empty();return Array.isArray(t)?t.forEach(function(t){n.append($("<p>").append(t))}):n.append(t),p}function w(t){var n,e,i;return t=$(['<div class="aut aut__s"> <div class="aut__logo"></div>\t<div class="aut__botlist">  <div class="aut__botlist__item aut__botlist__item__active js__aut">Accounts</div>  <div class="aut__botlist__r"></div>  <div class="aut__botlist__item js__conf">Confirmations</div> </div><div class="aut__body aut__stepMess"> <div class="aut__body__text"> <div class="aut__body__text_ aut__stepMess_text"></div> </div></div></div>','<div class="aut aut__s"> <div class="aut__logo"></div>\t<div class="aut__botlist">  <div class="aut__botlist__item aut__botlist__item__active js__aut">Accounts</div>  <div class="aut__botlist__r"></div>  <div class="aut__botlist__item js__conf">Confirmations</div> </div><div class="aut__body aut__step1"> <div class="aut__body__text">  <div class="aut__body__text_">    <p>Login or load your list of accounts</p>    <p><i class="btn js__login"><i>Login</i></i> <i class="btn js__load"><i>Load</i> <input type="file"/></i> </p>   </div>  </div></div></div>','<div class="aut aut__s"> <div class="aut__logo"></div>\t<div class="aut__botlist">  <div class="aut__botlist__item aut__botlist__item__active js__aut">Accounts</div>  <div class="aut__botlist__r"></div>  <div class="aut__botlist__item js__conf">Confirmations</div> </div><div class="aut__body aut__step2"> <div class="aut__body__form">  <div class="aut__stepForm"></div> <div><i class="btn red js__cansel"><i>Cancel</i></i> <i class="btn js__next"><i>Next</i></i></div> </div></div></div>','<div class="aut aut__s"> <div class="aut__logo"></div>\t<div class="aut__botlist">  <div class="aut__botlist__item aut__botlist__item__active js__aut">Accounts</div>  <div class="aut__botlist__r"></div>  <div class="aut__botlist__item js__conf">Confirmations</div> </div><div class="aut__body aut__step3"> <div class="aut__body__head">  <div class="act__sell">    <div class="act__sell__title"></div>    <div class="act__sell__list">      <div class="act__sell__list__accs"></div>      <div class="act__sell__list__hr"></div> <div class="act__sell__list__new"><span class="js__login">New account</span></div>    </div>\t </div>\t <div>\t <i class="btn js__save"><i>Save</i></i>\t <i class="btn js__load"><i>Load</i> <input type="file"/></i>\t </div>\t</div> <div class="aut__body__text"> <div class="aut__body__text_ aut__stepMess_text"></div> </div> <div class="aut__code"><div>\t\t\t<div class="aut__code__t">*****</div>\t\t\t<div><i class="btn js__aut__code"><i> Refresh and copy</i></i></div>\t</div></div> <div class="act__recovery">\t\t\t<div class="act__recovery__t">Recovery code</div>\t\t\t<div class="act__recovery__code">C00000</div>\t</div></div></div>','<div class="aut aut__s"> <div class="aut__logo"></div>\t<div class="aut__botlist">  <div class="aut__botlist__item aut__botlist__item__active js__aut">Accounts</div>  <div class="aut__botlist__r"></div>  <div class="aut__botlist__item js__conf">Confirmations</div> </div><div class="aut__body aut__step4">\t<div class="aut__body__text"><div class="aut__body__text_ aut__stepMess_text"></div></div>\t\t<div class="act__confirmation"></div>\t\t<div class="act__bottom">\t\t\t<div class="act__bottom__l">\t\t\t\t<i class="checkbox">\t\t\t\t\t<input type="checkbox" value="1" class="js-optType"/>\t\t\t\t\t<i></i>\t\t\t\t</i>&nbsp;Automatically confirm sale\t\t\t</div>\t\t\t<div class="act__bottom__r"><i class="btn js_conf_r"><i>Refresh</i></i></div>\t\t</div>\t</div></div>'][t]),n=$(".js__aut",t),e=$(".js__conf",t),n.click(function(){a(n,e)&&p.find(".act__confirmation")&&m()}),e.click(function(){f("ACT").getIsOpen()&&a(e,n)&&(l=u,p.find(".act__sell")&&0,p=b(),f("ACT").getConf())&&m()}),$(".js_conf_r",t).click(function(){f("ACT").getConf()&&m()}),$(".js__login",t).click(function(){T(0)({login:{placeholder:"Login"},pass:{type:"password",placeholder:"Password"}})}),$(".js__save",t).click(function(){function e(t){return{name:t.name,data:t.data,recovery:t.recovery}}x(function(t,n){t||(t=JSON.stringify(n.map(e)),n=c+function(t){return"1"+S(t,function(t){var n=parseInt(Math.round(122*Math.random())+68),t=t.charCodeAt(0)+n;return String.fromCharCode(t,n)}).join("")}(t),$("<a>",{textContent:"download",download:"accList.stha",href:"data:application/sth;charset=utf-8,"+encodeURIComponent(n)})[0].click())})}),$(".js__load input",t).change(function(){var t,n=this.files[0];n&&((t=new FileReader).onloadend=function(t){var n=this.result,n=function(t){if(t.substr(0,6)===c){t="1"==t.substr(6,1)&&function t(n){var e=n.length;if(e%2)return t(n.substr(7));e=S(n,function(t,n,e){return n%2?"":String.fromCharCode(t.charCodeAt(0)-e[n+1].charCodeAt(0))}).join("");return e}(t.substr(7));if(t&&"[{"===t.substr(0,2))return JSON.parse(t)}}((new TextDecoder).decode(n));n&&Array.isArray(n)&&f("ACT").insert(n,function(){m()})},t.readAsArrayBuffer(n))}),$(".js__aut__code",t).click(function(){var t=$(this).data("t"),n=now();t&&!(t<n)||f("ACT").getSG()||($(this).data("t",n+900),o=!0)}),i=$(".act__sell",t),t.find(".act__sell__title").click(function(){var t="act__sell__act";r=i.toggleClass(t).hasClass(t)}),$(".js-optType",t).click(function(){$("#wOptAutoConfirm").prop("checked",this.checked).trigger("change")}).each(function(){this.checked=f("data").wOptAutoConfirm}),t;function a(t,n){var e="aut__botlist__item__active";return!t.hasClass(e)&&(t.addClass(e),n.removeClass(e),1)}}function C(){return parseInt(localStorage.SellAcc)||0}function x(n){j.DB.accounts.get().then(function(t){t.length?n(null,t):n(1)}).catch(function(){n(1)}).finally(function(){n=null})}function S(t,n){return Array.prototype.map.call(t,n)}function T(t){return[c,function(e){n(e,function(t){l(e,t);var n=t.user.val,t=t.pass.val;n&&t&&(k(h),f("ACT").reauth(n,t,function(t,n){m()}))})},function i(a){n(a,function(t){var n=t.login.val,e=t.type.val,t=t.sms.val;t&&(k(h),f("ACT").aSms(n,e,t,function(t){t&&1!==t?(d(a,t),i(a)):m()},function(){m()}))})},s,u][t]||function(){};function c(r){n(r,function(o){l(r,o);var t=o.login.val,n=o.pass.val;t&&n&&(k(h),f("ACT").new(t,n,void 0,function(t,n,e){if(1===t)m();else if(t)d(r,t),c(r);else if("aC"===n){var t=r,i=e.params,a={};for(let t=0;t<i.length;t++)a["t"+t]=""+i[t];a.code={placeholder:"code"},s(a,t)}else"smsForm2"===n&&(l(e={login:{type:"hidden",text:o.login.val},pass:{type:"hidden"},SMS:{placeholder:"SMS code"}},o),u(e))}))})}function s(i,a){n(i,function(t){l(i,t);t=t.code.val;t&&(k(h),f("ACT").aC(t,function(t,n,e){1===t?m():t&&2===n?.code?(d(i,t),s(i,a)):t&&(d(a,t),c(a))}))},function(){m()})}function u(i){n(i,function(t){l(i,t);var n=t.login.val,e=t.pass.val,t=t.SMS.val;t&&(k(h),f("ACT").authMobale(n,e,t,function(t){1!=t&&t?t&&(d(i,t),u(i)):m(),i=null}))})}function n(n,t,e){var i,a,o=Object.keys(n).map(function(t){return $("<div>",{class:"aut__inp"}).append(function(t,n){if("string"==typeof n)return n;var e=$();n.text&&(e=e.add(n.text));(n.type||n.placeholder||n.value)&&(e=e.add($("<input>",{class:"inp",name:t,type:n.type||"text",placeholder:n.placeholder||"",value:n.value||""})));return e}(t,n[t]))});(p=w(2)).find(".aut__stepForm").empty().append(o),i=p,a=t,$(".js__cansel",i).click(function(){m()}),$(".js__next",i).click(function(){var e={};$(".aut__stepForm",i).find("[name]").each(function(t,n){e[n.name]={val:$(n).val(),inp:n}}),a&&a(e)}),B(p,e||_)}function l(t,n){for(var e in n)t[e]&&n[e].val&&(t[e].value=n[e].val)}function d(t,n){return n&&t&&("object"==typeof n?(n.captchaurl&&(t.captchaurl='<img src="'+n.captchaurl+'"/>',t.captcha={placeholder:"Captcha"}),n.message&&(t.err=n.message+"")):t.err=n),t}}i.change(function(){i.is(":checked")&&x(function(t,n){!t&&n&&n.length||(m(),i.prop("checked",!1).trigger("change"))})}),n={confirmations:function(t){l===u&&(p.find(".aut__body__text").hide(),b(t))},reAuth:function(){g()},authForm:function(){},smsForm:function(t){d(t)},finalizeTwoFactor:function(){},showFn:function(){t("ACT").getSG()},authCode:function(e,t){t&&s!=t?(a(null,n),x(function(t,n){t?m():y(n)})):n();function n(){var t,n;p&&((t=p.find(".aut__code__t")).length?(p.find(".aut__body__text").hide(),p.find(".aut__code").show(),t.text(e||"*****"),o&&((n=document.createRange()).selectNodeContents(t.get(0)),(t=j.getSelection()).removeAllRanges(),t.addRange(n),document.execCommand("copy",!1,null),t.setPosition(1))):m())}},close:function(t){101!==t&&m()}},$("#act").click(function(){m()}),t("ACT").setForm(n)}function Bt(e,t,l){function d(t,n){n?t.show().text(n):t.hide()}function n(t){return $("<label>",{for:t,class:"inp"}).appendTo($("#"+t).parent().addClass("relative"))}function f(t){var n,e;return 1<(t=t-now())&&(t=parseInt(t/1e3),n=parseInt(t%60),e=parseInt(t/60%60),[parseInt(t/3600),e,n].map(a).join(":"))}function i(t,n,e){var i=e?t:"wOptionsRate"+t,a=!0,o=!(e=e?null:"wOptionsChk"+t)||l("data").classChecClass,r=!e||l("data")[e],t=(e&&$("#wOptChkClassick").change(function(){(o=this.checked)&&r||u.off()}),e&&$("#"+e).change(function(){(r=this.checked)&&o||u.off()}),$("#"+i)),c=$("<label>",{for:i,class:"inp"}).appendTo(t.parent().addClass("relative")).hide(),s=$("<label>",{for:i,class:"inpSSIco"}).appendTo(t.parent().addClass("relative")).hide(),u={off:function(){c.hide(),s.hide(),a=!0},test:function(t){return r&&(t[n]!=a&&((a=t[n])?(c.hide(),s.hide()):(c.show(),s.show())),a||d(c,f(t[n+"T"]))),r&&a}};return u}var a=function(t){return t.toString().length<2?"0"+t:t},o=[i("wOptRateFilter","page",!0),i("wOptQORate","fortune",!0),i("PPrice","pp"),i("PageC","page"),i("Page","page"),i("NL","nl")],r=n("wOptionsRateRunTime"),c=l("data").wOptionsChkRunTime,s=($("#wOptionsChkRunTime").change(function(){c=this.checked}),n("wOptionsRateStopTime")),u=l("data").wOptionsRateStopTime;$("#wOptionsRateStopTime").change(function(){u=this.checked}),setInterval(function(){e.isOn?(o.reduce(function(t,n){return n.test(e)||t},!1)?t.addClass("play").removeClass("stop"):t.addClass("stop").removeClass("play"),u||c?d(s,f(e.timeOff||0)):s.hide(),c?d(r,f(e.timeOn||0)):r.hide()):(o.forEach(function(t){t.off()}),s.hide(),r.hide(),t.removeClass("stop").removeClass("play"))},1e3)}function Ot(o,n){function r(t,n,e){return $("<div>",{class:"contextMenu-item"}).append(n).click(e).appendTo(t)}var i=!1,a=$("#ActionsItem"),c=$(".contextMenu_text",a);function t(t,n){t=+t.data("id");j.DB.item.getOne(t).then(function(t){n(t)},{id:t})}function s(i,a){var t=+i.data("id");j.DB.item.getOne(t).then(function(t){var n,e;n=i,t=t,c.empty(),e=+n.data("id"),u(n,e,t),l(n,e,t),d(n,e,t),f(n,e,t),a()})}var u=function(t,n,e){var i,a;e&&(i=e[_],a=e[h],o("myListings").get("B",i,a),o("myListings").get("B",730,"UMP-45 | Carbon Fiber (Factory New)"))&&r(c,"Cancel order",function(){o("myListings").doBuyRemove(i,a,n)})},l=function(t,n,e){var i,a;e&&(i=e[_],a=e[h],e=o("myListings").get("S",i,a))&&(e=Object.keys(e).length,r(c,'<table class="w100p"><tr><td>Remove sale<td class="alignR">('+e+")",function(){o("myListings").doSellRemove(i,a,n)}))},d=function(t,n,e){t.hasClass("item_type2")&&(730==e[_]&&r(c,"Edit float",function(){formFloat(n,e)}).addClass("pay"),r(c,"Edit filter",function(){j.formFilter(n,e)}).addClass("pay"))},f=function(t,n){r(c,"Delete",function(){xt([n])}).addClass("contextMenu-item-red")};function p(t){Array.isArray(t)&&x(kt,{}),n()}$(j.document).on("click",".js-filter",function(){t($(this).closest(".item"),function(t){j.formFilter(t.id,t)})}),$(j.document).on("click",".js-float",function(){t($(this).closest(".item"),function(t){formFloat(t.id,t)})}),$(j.document).on("click",function(t){!i||$(t.target).is(".cont_menu")||$(t.target).closest(".cont_menu").length||(i=!1,a.hide())}),$(j.document).on("click",".cont_menu",function(){setTimeout(function(t){var n,e=$(t);e.is(i)?(a.hide(),i=!1):(i=t,(n=e.offset()).left+=4,s($(t).closest(".item"),function(){a.show(),Jt(a,n)}))},10,this)}),j.updateFilter=function(t,n){j.DB.item.up(t,{filter:n||""}).finally(function(){o("B").update(t),o("B2").update(t),p(t),t=null})},j.updateFloat=function(t,n,e){j.DB.item.up(t,{max_float:n||0,min_float:e||1}).finally(function(){o("B").update(t),o("B2").update(t),p(t),t=null})}}function At(t,n,e,i){function a(){var t=!!$(this).data("ok");y(),i(t)}n=$('<i class="btn" data-ok="true"><i>'+(n||"Ok")+"</i></i>").click(a),e=$('<i class="btn" ><i>'+(e||"False")+"</i></i>").click(a),n=$("<div>",{class:"falert--btn"}).append(n).append(e),e=$("<div>").append(t).append(n),y(e)}function jt(t){return 100*parseFloat(t.replace(",","."),2)||0}j.formFloat=function(e,t,i){var a,o;function r(t,n){return!t||(t.replace&&t.replace(",",". "),!(t=parseFloat(t)))||1<t||t<0?n:t}function n(t,n){return(t=!t||1<t||t<0?n:t)*Math.pow(10,5)%1?t+"":t.toFixed(5)+""}2==t.buy_type&&730==t.appid&&(a=t.min_float,o=t.max_float,Ft(t.name,n(o,0),n(a,1),function(t,n){null!==n&&(t=r(t,0),n=r(n,1),o===t&&a===n||j.updateFloat(e,t,n)),i&&i(),e=i=null}))},j.formFilter=function(n,t,e){var i;2==t.buy_type&&(i=t.filter,Ht("Filter: "+t.name,i,function(t){null!==t&&i!==t&&(j.updateFilter(n,t),e&&e(),n=e=null)}))},C(f,function(t){t.detail.STH;var e=t.detail.show;$("#chGrp").click(function(){var n=S();n.length&&j.DB.group.set({}).then(function(t){j.DB.item.up(n,{[d]:t||0}).finally(function(){Ct(function(){e(0,!0)})})})})}),C(f,function(t){t.detail.STH;var n=t.detail.show;$("#chUGrp").click(function(){var t=S();t.length&&j.DB.item.up(t,{[d]:0}).finally(function(){Ct(function(){n(0,!0)})})})}),C(f,function(t){function n(n,t){var e=S();if(!e.length)return t([]);var i=[];j.DB.item.for(e,function(t){n(t)&&i.push(t.id)}).finally(function(){t(i)})}$("#chGrpFilter").click(function(){n(function(t){return 2==t[o]},function(t){t.length&&j.formFilter(t,{buy_type:2,filter:null,name:"selected items"})})}),$("#chGrpFloat").click(function(){n(function(t){return 730==t[_]&&2==t[o]},function(t){t.length&&j.formFloat(t,{buy_type:2,appid:730,min_float:-1e-4,max_float:1.0001,name:"selected items"})})})}),C("STH_init",function(t){var o=t.detail.STH;$("#chBOn").click(function(){var t=on(S());t&&(o("B").add(t),j.DB.item.up(t,{b_on:1}).finally(function(){$(".b_on",k(t)).prop("checked",!0),t=null}))}),$("#chBOff").click(function(){var t=S();o("B").remove(t),j.DB.item.up(t,{b_on:0}).finally(function(){$(".b_on",k(t)).prop("checked",!1),t=null})}),$("#chBSum").change(function(){var t=this.value,n=g(t||0),e=S();t.length&&j.DB.item.up(e,{b_summ:n}).finally(function(){$(".b_Budget",k(e)).val(F(n)),o("B2").update(e),o("B").update(e),n=e=null}),this.value=""}),$("#chBSumMin").change(function(){var t=this.value,n=g(t||0),e=S();t.length&&n&&j.DB.item.up(e,{b_min:n}).finally(function(){$(".b_BudgetMin",k(e)).val(F(n)),o("B2").update(e),o("B").update(e),n=e=null}),this.value=""}),$("#chBCnt").change(function(){var t=Math.max(parseInt(+this.value||0),0),n=S();this.value.length&&j.DB.item.up(n,{b_cnt:t}).finally(function(){$(".b_Count",k(n)).val(t),o("B2").update(n),o("B").update(n),t=n=null}),this.value=""}),$("#chSSum").change(function(){var i=g(this.value||0),a=S();i&&j.DB.item.up(a,{s_summ:i}).finally(function(){j.DB.item.get(a).then(function(t){for(var n=t.length;n--;){var e=t[n];k(e.id).find(".s_Receive").val(F(i)),k(e.id).find(".s_Pays").val(F(b.getProc(i,e[r])))}o("B2").update(a),o("B").update(a),i=a=null})}),this.value=""}),$("#chSSumProc").change(function(){var e=+this.value||0,t=S();e&&(e=e/100+1,j.DB.item.for(t,function(t){var n=Math.floor(t[K]*e);j.DB.item.up(t.id,{s_summ:n}),k(t.id).find(".s_Receive").val(F(n)),k(t.id).find(".s_Pays").val(F(b.getProc(n,t[r]))),o("B2").update(t.id),o("B").update(t.id)})),this.value=""}),$("#chSSumR").change(function(){var i=g(this.value||0),t=S();i&&j.DB.item.for(t,function(t){var n=t[r],e=b.getReProc(i,n);j.DB.item.up(t.id,{s_summ:e}),k(t.id).find(".s_Receive").val(F(e)),k(t.id).find(".s_Pays").val(F(b.getProc(e,n))),o("B2").update(t.id),o("B").update(t.id)}),this.value=""}),$("#chSOn").click(function(){var t=S();o().S.add(t),j.DB.item.up(t,{s_on:!0}).finally(function(){$(".s_on",k(t)).prop("checked",!0),o("B2").update(t),o("B").update(t),t=null})}),$("#chSOff").click(function(){var t=S();o().S.remove(t),j.DB.item.up(t,{s_on:!1}).finally(function(){$(".s_on",k(t)).prop("checked",!1),o("B2").update(t),o("B").update(t),t=null})})}),C(f,function(n){function e(){t.focus().addClass("error"),setTimeout(function(){$("#AddUrl_text").removeClass("error")},2e3)}var o=n.detail.STH;$("#AddUrl").click(function(){var t,i=$("#AddUrl_text"),a=i.val();return a&&/(https|http):\/\/steamcommunity.com\/market\/listings\/([0-9]+)\/(.+)/.test(a)&&(t=o().pURL(a))?void j.DB[N](t.hash_name).then(function(t){var n,e;t?(t=t,(e=(e=document.getElementById("item_"+t.id))||document.getElementById("gr_"+t[d]))?(t=$(e).closest(".t-s"),(n=e.offsetTop-(t.height()/2-e.clientHeight/2))<0&&(n=0),t.scrollTop(n),e.classList.add("animationHeight"),setTimeout(function(){e.classList.remove("animationHeight")},2500)):j.location.reload()):(i.val(""),o().addUrl(a))}):e()})}),$(j).on("load",function(){var e=0,d=(C(wt,function(t){e=t.detail.top}),"do_move_g"),f="do_move_i",i=f+"_top";function a(t){var n=this,e=n.$list_item.filterY(n.top,4).first();o(e,f,n.$list_item),o(n.$list_tbody_group.filterY(n.top,4),d,n.$list_tbody_group),p(n.top,e)?e.addClass(i):e.removeClass(i)}function p(t,n){return t<(n.length?n.offset().top+n.height()/2:0)}function o(t,n,e){t.hasClass(n)||((e?$(e).filter("."+n):$("."+n,e)).removeClass(n),t.addClass(n))}function r(t,n){var e=this;e.title=$("<div>",{class:"bMove"}).appendTo(".t-s").text("Items "+n.length),e.$list_item=$(".t-s tr.item"),e.$list_tbody_group=$(".t-s tbody"),e._move_fn=[],e._end_fn=[],e.ids=n,e.listener_move(a),k(e.ids).addClass("do_move"),e.set_point(t)}r.prototype.set_point=function(t){this.top=t.top-e,this.title.css(t)},r.prototype.listener_move=function(t){this._move_fn.push(t)},r.prototype.move=function(t){var n=this;n.set_point(t),clearTimeout(n._move_t),n._move_t=setTimeout(function(){n._move_fn.forEach(function(t){t.apply(this)},n)},100)};var n,c=!(r.prototype.end=function(t){var n,e,i,a,o,r=this,c=(r._end_fn.forEach(function(t){t.apply(this)},r),c=r.top,n=r.$list_item,(e=(e=r.$list_tbody_group).filterY(c,4)).length?(e={id_g:e.data("idg")},(n=n.filterY(c,4)).length?(n.offset().top,n.height(),e.id_i=+n.data("id"),p(c,n)?e.do="before":e.do="after"):e.do="append_g",e):null);function s(t,n,e){var i=u(n.slice(0,t)),n=u(n.slice(t));return i.concat(e,n)}function u(t){return t.filter(function(t){return-1===i.indexOf(t)})}function l(t){for(var n in t)t[n]=null}c&&(i=r.ids,o={append_g:function(t){t=u(t);return i.concat(t)},before:function(t,n){return s(t.indexOf(n),t,i)},after:function(t,n){return s(t.indexOf(n)+1,t,i)}},Kt((a=c).id_g,function(t){t=o[a.do](t,a.id_i);zt(t,a.id_g)}),k(r.ids).remove()),r.title.remove(),l(r._move_fn),l(r._end_fn),l(r),$("."+d).removeClass(d),$("."+f).removeClass(f)});function s(t,n){return{top:t+e,left:n}}$(document).on("mousedown",".move",function(t){var n;c=c||new r(s(t.pageY,t.pageX),(t=+$(this).closest("tr").data("id"),-1!==(n=S()).indexOf(t)?n:[t]))}).on("mouseup",function(t){c&&(c.end(),c=!1)}).on("mousemove",function(t){c&&(clearTimeout(n),n=setTimeout(function(){c&&c.move(s(t.pageY,t.pageX))},10))})}),C("STH_init",function(t){function n(t){e("data").viewResive=t?1:"",$("body")[t?"addClass":"removeClass"]("viewResive")}var e=t.detail.STH,i=t.detail.show;$('input[type="number"]').on("change",function(t){/[^0-9]/.test(this.value)&&(this.value=parseInt(this.value))});$(".js-Pays").click(function(){n(!1)}),$(".js-Receive").click(function(){n(!0)}),n(e("data").viewResive),$("#rrr").click(function(){localStorage.sellColl=localStorage.sellColl?"":"1",i()})}),C(f,function(t){var e=t.detail.show;function i(t,n,e){t=+$(t).closest(".grp").data("id");j.DB.group.up(t,n).finally(e)}$(j.document).on("click","#Group .close",function(){$(this).closest(".grp").removeClass("grp_1").addClass("grp_0").nextAll(".item").remove(),i(this,{[Q]:!1})}).on("click","#Group .open",function(){$(this).closest(".grp").removeClass("grp_0").addClass("grp_1");var t=+$(this).data("id");i(this,{[Q]:!0},()=>e(t,!0))}).on("change","#Group .js-grp-name",function(){i(this,{name:this.value||""},()=>e())}).on("change","#Group .js-grp-quantity",function(){var t=parseInt(this.value)||0;this.value=t||"",i(this,{[c]:t},()=>e())}).on("click","#Group .grp-col-sel i",function(){for(var t=$(this),n=0;n<18;++n)if(t.is(".col_"+n))return void i(t,{type:n},()=>e())})}),C(f,function(t){var c=t.detail.STH;function o(t,n,e){var i=+t.dataset.id;return j.DB.item.up(i,n).finally(function(){e&&e(i),c("B2").update(i),c("B").update(i),e=i=null}),i}c("on","edit:page",function(t){setTimeout(function(){j.DB.item.getOne(t).then(function(t){t&&k(t.id).find(".b_Count").val(t[s])})},10)}),$(j.document).on("change",".b_Count",function(){o(this,{b_cnt:this.value=Math.floor(+this.value||0)})}).on("change",".b_Budget",function(){var t=g(this.value||0);this.value=F(t),o(this,{b_summ:t})}).on("change",".b_BudgetMin",function(){var t=g(this.value||0);this.value=F(t),o(this,{b_min:t})}).on("change",".b_on",function(){var t=on(this.checked);c("B")[t?"add":"remove"](o(this,{b_on:t?1:0})),c("B2")[t?"add":"remove"](o(this,{b_on:t?1:0})),$(this).prop("checked",t)}).on("click",".js-BuyOrder",function(t,n){var e,i=$(this),a=+i.data("id"),o="time",r=i.hasClass("red");i.hasClass("disabled")||i.hasClass(o)||(i.addClass(o),setTimeout(function(t,n){t.removeClass(n)},15e3,i,o),r||(e=k(a),[".b_Count",".b_Budget"].every(function(t,n){t=e.find(t);return 0<t.val()||(setTimeout(function(t){t.focus()},10*n,t),!1)}))?c("B2").doBuy(a,r):i.removeClass(o))}).on("change",".s_Receive",function(t,n){var e=this,i=n||g(e.value||0),a=(e.value=F(i),$(e).closest("tr"));j.DB.item.getOne(+a.data("id")).then(function(t){t&&(a.find(".s_Pays").val(F(b.getProc(i,t[r]))),o(e,{s_summ:i}))}).finally(function(){i=a=null})}).on("change",".s_Pays",function(){var n=g(this.value||0),e=$(this).closest("tr");j.DB.item.getOne(+e.data("id")).then(function(t){e.find(".s_Receive").trigger("change",b.getReProc(n,t[r]))}).finally(function(){n=e=null})}).on("focus",".inpRightTab,.inpLeftTab",function(){$(this).addClass("focus").siblings("input").addClass("noFocus")}).on("focusout",".inpRightTab,.inpLeftTab",function(){$(this).removeClass("focus").siblings("input").removeClass("noFocus")}).on("change",".s_on",function(){var t=this.checked;c().S[t?"add":"remove"](o(this,{s_on:t?1:0}))}).on("click",".move-up",function(){var t=$(this).closest(".item"),n=t.prev(".item");n.length&&(t.insertBefore(n),seveSortAll())}).on("click",".move-down",function(){var t=$(this).closest(".item"),n=t.next(".item");n.length&&(n.insertBefore(t),seveSortAll())})}),$(j).on("load",function(){var t;$(".t-s").on("scroll",function(){clearTimeout(t),t=setTimeout(function(){x(wt,{top:$(".t-s").scrollTop()}),$(".t-s").scrollTop()},50)})}),C(f,function(t){t.detail.show;var o={n:J,b:K,q:s,s:nt},r={p:"price",o:"orders"};function n(t,n){function e(t,n){return t[i]>n[i]?a?-1:1:t[i]<n[i]?a?1:-1:0}var i,a;o[t]?(i=o[t],a=n,j.DB.item.get().then(function(t){zt(t.sort(e).map(t=>t.id))}).catch(function(){zt([])})):r[t]&&qt(r[t],n)}$(".t-h .sort").click(function(){n(this.dataset.t,!1)}),$(".t-h .reSort").click(function(){n(this.dataset.t,!0)})}),$;var a,It,Pt,p,Lt,e,m,Rt,Mt,Et,v,Dt=function(t,n,e){var i=+t.data("id"),a=n?n.inOrder(i):-1,n=0<a&&n.order(i),o=(i=t.find(".js-BuyOrder"),o={"-1":"—",0:"Place order",1:"Cancel order"}[a=a]||"—",-1!==a?i[a?"addClass":"removeClass"]("red").removeClass("disabled"):i.addClass("disabled"),i.find("i").text(o),(a=t.find(".OrderInfo"))[(i=n)?"addClass":"removeClass"]("hasOrder"),i&&a.find(".OrderInfoText").html("Q:"+i.count+"&nbsp;P:"+F(i.price)),t.find(".SellInfo")),n=e;n=e(o.data("appid"),o.data("hash")),o[n?"addClass":"removeClass"]("hasSell")},g=function(t){return"string"==typeof t&&(t=t.replace(",",".")),Math.round(100*t)},Ft=(Pt=function(){},$(j).on("load",function(){a=$("#popupForm");o=$(".range0",a)[0],c=448-(r=5),t=o.parentNode,n=o.getAttribute("data-e").split(" "),s=document.createElement("div"),t.insertBefore(s,o),s.classList.add("multiple-range"),t=n.map(function(t){function n(){var t;i.style.left=(t=e.value,r+t*c+"px")}var t=o.form.querySelector("."+t),e=o.cloneNode(),i=(e.value=t.value,e.type="range",e.removeAttribute("data-values"),document.createElement("div")),a=(i.classList.add("multiple-range-val"),n(),$(e).on("input",n),s.prepend(i),s.append(e),{e:e,eLink:t,setVal:function(t){this.e.value=this.eLink.value=t,n()}});return t.range=e.range=a}),o.remove();var o,r,c,t,n,s,i=t;Pt=function(t,n){var e;n<t&&(e=n,n=t,t=e),i[0].setVal(n),i[1].setVal(t)},$("form",a).on("change",function(){var t=this.min.value,n=this.max.value;t<n||(this.min.range.setVal(n),this.max.range.setVal(t))}),$("form",a).on("input",function(t){t=t.target;t&&t.range&&t.range.setVal(t.value)}),$(".close,.Ok",a).click(function(){if(a.hide(),It){var t=$("form",$("#popupForm"))[0];if(t)return $(this).hasClass("Ok")?It(t.min.value,t.max.value):It(null,null)}})}),function(t,n,e,i){a&&(a.show(),$(".js_text",a).empty().append(t),Pt(n,e),It=i)}),Ht=($(j).on("load",function(){p=$("#fprompt"),$(".close,.Ok",p).click(function(){p.hide(),Lt&&Lt($(this).hasClass("Ok")?$("#fprompt_text").val():null)})}),function(t,n,e){p&&(p.show(),$(".text",p).empty().append(t),$("#fprompt_text",p).val(n)),Lt=e}),y=function(t,n,e){var i=$("#falert");t?(i.removeAttr("style").empty().append(t).show(),e&&i.css(e),n&&$('<i class="btn"><i>Ok</i></i>').appendTo(i).click(function(){y()})):i.hide()},B=($(j).on("load",function(){e=$("#falert2"),$(".close",e).click(function(){e.hide(),"function"==typeof fn&&fn()})}),function(t,n){e&&(e.show(),$(".text",e).empty().append(t),0)}),F=function(t){return t/100},b={getProc:function(t,n){return Math.max(t,1)+Math.max(Math.floor(t*(n||10)/100),1)+Math.max(Math.floor(.05*t),1)},getProcPr:function(t,n){return this.getProc(g(t,n))},getReProc:function(t,n){var e=105+(n||10),n=Math.max(Math.floor(t/e*(n||10)),1)+Math.max(Math.floor(t/e*5),1);return Math.max(t-n,1)},getReProcPr:function(t,n){return this.getProc(g(t,n))}},Nt=((m=mt.jQuery).fn.addAll=function(){return[].reduce.call(arguments,function(t,n){return t.add(n)},this)},m.fn.getPrice=function(t){var n,e=this.data(),i=e.url;t&&i?(n=this,ajax("https://steamcommunity.com/market/priceoverview/?country="+t.country+"&currency="+t.currency+"&"+i,function(t){e.t=now(),n.html((e.p=JSON.parse(t).lowest_price)||"-"),e=n=null})):this.text("-")},m.fn.filterY=function(e,t){var i=parseInt(t)||0;return this.filter(function(){var t=m(this),n=t.offset().top,t=t.height();return n-i<e&&e<n+t+i})},m.fn.fView=function(){var n;return this.length?(n=m(mt).height(),this.filter(function(){var t=m(this).offset().top;return 0<t+m(this).height()&&t<n})):this},m.fn.some=function(t,n){for(var e=0,i=this.length;e<i;e++)if(this.hasOwnProperty(e)&&(void 0===n?t(this[e],e,this):t.call(n,this[e],e,this)))return!0;return!1},Array.isArray,Rt=Array.isArray,Mt=function(t){var n=t.teg||(t.href?"a":"span"),e={},n=(t.css&&(e.css=t.css),t.href&&(e.href=t.href,e.target="_blank"),$("<"+n+">",e));return t.t&&n.append(v(t.t)),n},Et=function(t){return document.createTextNode(t)},v=function(t){return Rt(t)?t.map(v):("object"==typeof t?Mt:Et)(t)},function(t){return t?Rt(t)?(i=t.length-1,t.reduce(function(t,n,e){n=v(n);return Rt(n)?t=t.concat(n):t.push(n),e<i&&t.push("<br/>"),t},[])):v(t):"";var i}),qt=function(){};C(f,function(t){var n=t.detail.STH,i={price:function(t){return{id:t,sort:n().B.getPrice(t)||n().B2.getPrice(t)||0}},orders:function(t){return{id:t,sort:n().B2.getPriceBuy(t)||0}}};function a(t,n){return t.sort===n.sort?0:!t.sort||n.sort&&t.sort>n.sort?1:-1}function o(t,n){return t.sort===n.sort?0:!t.sort||t.sort<n.sort?1:-1}qt=function(n,e){Kt(null,function(t){t=t.map(i[n]).sort(e?o:a).map(function(t){return t.id});zt(t)})}}),Gt=function(){},C(f,function(t){var n=t.detail.show;Gt=function(t){n(t,!0)}});var Gt,Qt,Ut,Vt,zt=function(n,i){var t;function e(){var t=n.length;function e(){--t<=0&&(nn(),Gt(i))}nn(n),Gt(i),n.forEach(function(t,n){j.DB.item.up(t,{[z]:n}).finally(e)})}null==i?e():(t=i,j.DB.item.up(n,{[d]:t},e))},Jt=(Ut=0,$(j).on("load",Wt).resize(Wt),function(t,n){var e,i;Qt&&Ut&&(e=t.outerHeight(),t[(i=n.top+e+24>Ut)?"addClass":"removeClass"]("contextMenuB"),n.top+=i?-(8+e):24,n.top+=Qt.scrollTop(),t.css(n))});function Wt(){Qt=$(".left .t-s"),Ut=$(this).height()-60}function Yt(t,n){j.DB.getCtn().then(function(t){t?n(null,t.c,t):n(!0)})}function Xt(t){return $("#gr_"+(t.join?t.join(",#gr_"):t))}function k(t){return $("#item_"+(t.join?t.join(",#item_"):t))}function Kt(t,n){Zt(t,function(t){n(t.map(function(t){return t.id}))})}function Zt(t,n){j.DB[D](t).then(function(t){n(t.sort(function(t,n){return t[z]-n[z]}))}).catch(function(){n([])})}C(gt,function(t){t=t.detail.keys_list.length;$("#chCnt").text(t),$("body")[0<t?"addClass":"removeClass"]("bGr")}),Yt(0,function(t,c){C("STH_interval",function(i){var t,n,e,a=i.detail.STH,o=i.detail.pay,r=$(".item .inp:focus").closest(".item");r.find(".Prise").fView().each(function(){var t=now(),n=$(this),e=n.data();t>(e.time||0)&&(e.time=t+6e4,n.getPrice(a("authS")()))}),a("start")&&(a("myListings")(),(r=(t=$(".item").fView()).not(r)).find(".Prise").each(function(){var t=a().B.getCnt(+this.dataset.id);null!==t&&$(this).val(t)}),r.find(".Prise").each(function(){var t=a().B.getPrice(+this.dataset.id)||a().B2.getPrice(+this.dataset.id);$(this).text(t?F(t):"—")}),r.find(".Order").each(function(){var t=a("B2").getPriceBuy(+this.dataset.id);$(this).text(t?F(t):"—")}),n=a("B2"),e=a("myListings"),t.each(function(){var t=$(this);Dt(t,n,function(t,n){return e.get("S",t,n)})})),a("authS")()&&$("#balance").text(a("authS")().balance),Yt(0,function(t,n,e){t||(c!==n&&(c=n,i.detail.show()),jn(o,e,a("stat"),a))}),o!==a("isPay")&&j.location.reload()})}),Vt=$("<div>").css({position:"absolute",height:0,width:1,top:1,left:1}).appendTo(".t-s"),C(yt,function(){var t=$(".t-s >.t-b").map(function(){return $(this).outerHeight(!0)}).get().reduce(function(t,n){return t+n},0);Vt.height(t).show()}),C($t,function(){Vt.height(1).hide()}),C(f,function(t){var n,f=t.detail.STH,b="item_info__text__small",i=document.querySelector(".t-s"),k=document.getElementById("item_info"),w=k.querySelectorAll(".item_info__graph_acc__on"),C=!1,p=null,x=null,S="";function a(){k.classList.remove("show"),k.classList.add("load")}function T(t,n){var t=(t.match(n)||[]).pop();return(t=t&&String(t.replace(n,"$1")))?JSON.parse('{"text":"'+t+'"}').text:""}function B(t){C===t&&(k.classList.add("item_info_err","show"),k.classList.remove("load"))}function O(t,n){var e=n.replace(/<(?:.|\n)*?>/gm,"").split("\n").map(function(t){return document.createTextNode(t)});t.appendChild(e[0]);for(var i=1;i<e.length;i++)t.appendChild(A("br")),t.appendChild(e[i])}function A(t,n){n=n||{};var e,i=document.createElement(t);for(e in n)i.setAttribute(e,n[e]);return i}i&&((n=k.querySelector(".item_info__text__btn_expand"))&&n.addEventListener("click",function(t){n.parentNode.classList.remove(b),t.preventDefault()},!1),document.body.addEventListener("click",function(t){!C||t.target.classList.contains("item-img-btn")&&C!==+t.target.dataset.id||t.target.closest("#item_info")||(C=!1,a())}),w.forEach(function(e,i){e.addEventListener("click",function(){var t,n=e.classList;n.contains("action")||(n.add("action"),w.forEach(function(t,n){i!=n&&t.classList.remove("action")})),p?(n=p,t=e.dataset.c,k.classList.remove("hiddenGraph"),k.querySelector(".item_info__graph_currency").innerText=S,function(t,n,e,i,a,o,r){var c=20,s=2,u=30,l=0,d=d3.select(t),t=d3.select(n),f=d3.select(e),n=(t.html(""),t.attr("width")||380),e=t.attr("height")||150,p=(t.attr("height",e).attr("width",n),n-l-s),h=e-c-u,_=d3.scaleTime().range([0,p]),m=d3.scaleLinear().range([h,0]),n=(_.domain(d3.extent(i,function(t){return t[a]})),m.domain(function(t,n){var e=n-t;if(1<e)return[Math.floor(t),Math.ceil(n)];if(.1<e)return[Math.floor(10*t)/10,Math.ceil(10*n)/10];return[t-.01,n+.01]}(d3.min(i,function(t){return t[o]}),d3.max(i,function(t){return t[o]}))),d3.line().x(function(t){return _(t[a])}).y(function(t){return m(t[o])})),s=t.append("g").attr("transform","translate("+l+","+c+")");function v(){return d3.axisBottom(_).ticks(6)}function g(t){return d3[t?"axisRight":"axisLeft"](m).ticks(4)}function y(t){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()]+" "+t.getDate()}s.append("g").attr("class","grid").attr("transform","translate(0,"+h+")").call(v().tickSize(-h).tickFormat("")),s.append("g").attr("class","grid").call(g().tickSize(-p).tickFormat(""));var $=s.append("line").attr("class","x").attr("y1",0).attr("y2",h);s.append("path").data([i]).attr("class","line").attr("d",n),s.append("g").selectAll(".bar").data(i).enter().append("rect").attr("class","bar").style("opacity",0).attr("x",function(t){return _(t[a])}).attr("width",function(t){return p-_(t[a])}).attr("y",function(){return 0}).attr("height",function(){return h}).on("mouseover",function(t){var n,e,i;f.select(".y1").text((n=t[a],e=n.getHours(),i=12<=e?"PM":"AM",0==(e%=12)&&(e=12),y(n)+" "+e+i)),f.select(".y2").text(Math.round(100*t[o])/100),f.select(".y3").text(t[r]+" sold"),$.attr("transform","translate("+_(t[a])+",0)")}),s.on("mouseover",function(t){d.classed("item_info__graph__hover",!0)}).on("mouseout",function(){d.classed("item_info__graph__hover",!1),f.selectAll(".y1,.y2,.y3").text("")}),s.append("g").attr("class","lineNav").attr("transform","translate(10,"+h+")").call(v().tickFormat(y).tickSize(0)).selectAll("text").attr("transform","translate(0,5)");s.append("g").attr("transform","translate(0,0)").attr("class","lineNav lineNavY").call(g(!0).tickSize(0)).selectAll("text").attr("transform","translate(10,0)")}(".item_info__graph",".item_info__graph svg",".item_info__graph__focus",t?function(t,n){var e=new Date(Date.now()-24*n*60*60*1e3);return t.filter(function(t){return t.date>=e})}(n,t):n,"date","price","count")):k.classList.add("hiddenGraph")})}),i.addEventListener("click",function(t){var n,c,s,u,l,d;function e(t){var n,e=s+10+t,i=s+u;if(t<u)for(var a,o,r=t;;){if(r=parseInt(r/2),a=l-r,o=l-t+r,r<=10)break;if(s<a&&a+t<i){n=a;break}if(s<o&&o+t<i){n=a;break}n=l-r}else e<d&&(n=d-t);k.style.top=(n=(n=(n=s+u<n+t?s:n)+t<l+20?l+20-t:n)<0?0:n)+"px",c.style.top=l-n+"px"}t.target.classList.contains("item-img-btn")&&(n=+t.target.dataset.id,C==n?(C=!1,a()):(t=t.target,c=k.querySelector(".l_start"),s=i.scrollTop,u=i.clientHeight,l=function t(n){if(!n)return 0;if(n.classList.contains("t-s"))return 0;return n.offsetTop+t(n.offsetParent)}(t),d=l+20,x=function(t,n){C==t&&(e(k?k.clientHeight:100),n)&&setTimeout(function(){e(k.clientHeight)},600)},t=C=n,C===t&&j.DB.item.getOne(t).then(function(t){var u,l,d,n;t&&(n=t.id,C=n,k.classList.add("show","load"),k.classList.remove("item_info_err"),x(n,!1),u=t.id,l=t[J],n=t[U],d=t,pGet(n).then(function(t){var h=u,_=l,n=d;if(C===h){var m,v,g,e=(t.match(/(?:g_rgAppContextData[\s]*\=[\s]*)(\{[^\n]+\};)/g)||[]).pop(),i=(t.match(/(?:g_rgAssets[\s]*\=[\s]*)(\{[^\n]+\};)/g)||[]).pop(),a=(t.match(/(?:line1[\s]*\=[\s]*)(\[[^\n]+\];)/g)||[]).pop(),o=T(t,/(?:strFormatPrefix[\s]*=[\s]*"([^"]*)")/g),r=T(t,/(?:strFormatSuffix[\s]*=[\s]*"([^"]*)")/g);if(!i)return void B(h);m=json_parse(e.replace(/(?:g_rgAppContextData[\s]*\=[\s]*)(\{[^\n]+\});{0,1}/g,"$1"))||{},e=json_parse(i.replace(/(?:g_rgAssets[\s]*\=[\s]*)(\{[^\n]+\});{0,1}/g,"$1"))||{},i=json_parse(a.replace(/(?:line1[\s]*\=[\s]*)(\[[^\n]+\]);/g,"$1"))||[],v=String(o.replace(/(?:strFormatPrefix[\s]*=[\s]*"([^"]*)")/g,"$1")),g=String(r.replace(/(?:strFormatSuffix[\s]*=[\s]*"([^"]*)")/g,"$1"));var y=function(t,n,e){var i=new Date,t=(i.setDate(i.getDate()-1),t.filter(function(t){return new Date(t[0])>i})),a={p:0,s:0};return t.length&&((a=t.reduce(function(t,n){return t.p+=100*n[1],t.s+=+n[2],t},a)).p=n+parseInt(a.p/t.length)/100+e),a}(i,v,g),$=(p=function(t){return Array.isArray(t)?t.map(function(t){return{date:new Date(t[0]),price:t[1],count:t[2]}}):[]}(i),function(t){var n,e,i;for(n in t)for(e in t[n])for(i in t[n][e])return t[n][e][i];return null}(e));try{var c=f().authS()||{};1!=n.buy_type?function(t,n,e){var r=t.TwoFactor,t=(n.match(/(?:g_rgListingInfo[\s]*\=[\s]*)(\{[^;]+\})/g)||[]).pop();if(!t)return e(0);n=json_parse(t.replace(/(?:g_rgListingInfo[\s]*\=[\s]*)(\{[^;]+\})/g,"$1"))||{};(n=Object.values(n).map(function(t){var n=parseInt,e=n(t.converted_price_per_unit),i=n(t.converted_price_per_unit)+n(t.converted_fee_per_unit),a=n(t.converted_fee_per_unit),o=n(t.converted_publisher_fee_per_unit),n=n(t.converted_steam_fee_per_unit);return a!=o+n||i!=e+o+n?{price:0}:(r&&(i-=n),{price:i})}).filter(function(t){return!!t.price}).sort(function(t,n){return t.price>n.price})).length?e(n[0].price):e(0)}(c,t,s):function(t,n,e){var i=(t||{}).TwoFactor?0:1,a="https://steamcommunity.com/market/itemordershistogram?"+["country="+t.country,"language="+t.language,"currency="+t.currency,"item_nameid="+n,"two_factor="+i].join("&");j.get(a,"json").done(function(t){e(+t.lowest_sell_order||0)}).fail(function(t){e(0)}).always(function(){a=e=null})}(c,n.item_nameid,s)}catch(t){s(0)}}function s(t){y.lowest=0<t?v+t/100+g:"-";var t=h,n=_,e=$,i=m,a=y,o=v;if(C===t){k.querySelector(".item_info__img img").src=function(t,n,e,i){{var a;if(t)return e=e||0,a="",0==(n=n||0)&&0==e||(a="/"+n+"x"+e,i&&2<=j.devicePixelRatio&&(a+="dpx2x")),"https://steamcommunity-a.akamaihd.net/economy/image/"+t.trim()+a}return"https://steamcommunity-a.akamaihd.net/public/images/trans.gif"}(e.icon_url,"330","192"),S=o;var t=k,o=i[e.appid].icon,i=i[e.appid].name,r=e.type;t.querySelector(".item_info__app__ico").src=o,t.querySelector(".item_info__app__name").innerText=i,t.querySelector(".item_info__app__type").innerText=r,k.querySelector(".item_info__head__data1").innerText="Starting at: "+(a.lowest||" No offers"),k.querySelector(".item_info__head__data2").innerText="Volume: "+a.s+" sold in the last 24 hours",k.querySelector(".item_info__head__data3").innerText="Median price: "+(a.p?a.p+" in the last 24 hours":"-"),k.querySelector(".item_info__head").innerText=n||"-";for(var i=o=k.querySelector(".item_info__text"),c=o.querySelector(".item_info__text__val"),s=e.descriptions;0<c.children.length;)c.children[0].remove();if(s&&s.length){i.classList.remove(b);for(var u=0;u<s.length;u++){var l,d,f,p=s[u];p.value&&0!=(l=p.value.replace(/\[date\](\d*)\[\/date\]/g,function(t,n){return new Date(1e3*n).toLocaleString()}).trim()).length&&(d=A("div",{class:"descriptor"}),p.color&&(d.style.color="#"+p.color),p.label&&((f=A("span",{class:"descriptor_label"})).innerText=p.label+": ",d.appendChild(f)),"image"==p.type?(f=A("img",{src:p.value.trim()}),d.appendChild(f)):("html"==p.type||"bbcode"==p.type?function(n,t){t.split("<br/>").forEach(function(t){O(n,t)})}:O)(d,l),c.appendChild(d))}70<i.offsetHeight&&i.classList.add(b)}}w[0].click(),k.classList.remove("load"),x(h,!0)}},function(t){B(u)}))})))}))});var tn=[];function nn(t){tn=t||[]}var en={};function an(t){$.get(t,{},function(t){en=Object.assign(en,t);var n,e=t;for(n in e){i=void 0;a=void 0;o=void 0;r=void 0;var i=n;var a=e[n];var o=document.querySelectorAll(".ico_appid_"+i);if(0<o.length&&o[0].src!==a)for(var r in o)o[r].src=a}},"json")}var on=function(t,n){return t};function rn(){$.get("https://steamtraderhelper.com/info/help.json",{},function(e){var n,i="activ",a="help",o=($(document).on("click",function(t){n&&!$(t.target).closest("."+a).length&&(n=void n.removeClass(i))}),function(){var t=$(this).closest("."+a);n&&!n.is(t)&&n.removeClass(i),n=t.hasClass(i)?void t.removeClass(i):t.addClass(i)});$("[data-help]").each(function(){var t=$(this),n=t.data("help");e[n]&&(t=t,n=e[n],n=Nt(n),$("<div>",{class:a}).append($("<div>",{class:a+"_q",text:"?"}).click(o),$("<div>",{class:a+"_t"}).append(n)).appendTo(t.addClass(a+"_block")))})},"json")}function cn(t,n){var a=$(".js-selTh"),o=$(".js-selAcc");return(cn=function(c,t,n){function s(){x($t,{[d]:c,is_show_check:t})}x(yt,{[d]:c}),function(t){$("body")[t?"addClass":"removeClass"]("body_rewers_sell_col");var n=$(".thSHBraz",a),t=t?[".js-Receive",".js-Pays",".js-selAccP",".js-selAccR"]:[".js-Pays",".js-Receive",".js-selAccR",".js-selAccP"],e=$(t[0],a),i=$(t[1],a),n=(n.before(e.removeClass("thSHBR").addClass("thSHBL")).after(i.removeClass("thSHBL").addClass("thSHBR")),$(t[2],o)),e=$(t[3],o);o.append(n.removeClass("inpRightTab").addClass("inpLeftTab"),e.removeClass("inpLeftTab").addClass("inpRightTab"))}(localStorage.sellColl),function(t,n){j.DB.group.get(t||void 0,t?void 0:"g_name").then(function(t){n(t||[])}).catch(function(){n([])})}(c,function(t){function e(){a&&o&&n()}var n,i,a,o,r;c?(r=s,t.forEach(function(n){l(n,function(t){Xt(n.id).parent().replaceWith(t),r()})})):(t=t,n=s,i=new Array(t.length),o=a=!1,t.forEach(function(t,n){l(t,function(t){i[n]=t,i.some(function(t){return"string"!=typeof t})||($("#Group").html(i.join("")),a=!0,e())})}),u(0,function(t){$("#Inventars").html(t),o=!0,e()}))})}).apply(this,arguments);function r(t){var n=new w($("#group").text());return(r=function(t){return n.data(t)})(t)}function u(t,n){var o;o=function(t){t=t.map(function(t){return dn(t)});n(t.join("")),n=null},Zt(t,function(t){var n=t.length,e=new Array(n);if(tn.length)for(var i=0;i<n;++i){var a=t[i];e[adb_items_idgroup_sort.indexOf(a.id)]=a}else for(i=0;i<n;++i)e[i]=t[i];o(e)})}function l(n,e){var i={quantity_val:n[c]||"",quantity_deff:parseInt($("#wOptBuyOrderCnt").val())||1};n[Q]?u(n.id,function(t){e(r(Object.assign(i,n,{items:t,open:1}))),i=null}):(e(r(Object.assign(i,n,{open:0}))),i=null)}}function sn(){var e=!0,i=!0,a=chrome.runtime.getManifest().version;function o(t){var n=$("<br/>"),e=$('<i class="btn"><i>Close</i></i>').click(function(){y()}),i=$("<p>",{text:"Software version updated"});t.forEach(function(t){i=i.add(c(t)).add(n.clone())}),i=i.add(n.clone()).add(e),y(i,0,{})}function r(t){Array.isArray(t)&&($("#lTop").html(""),t.forEach(function(t){c(t).appendTo("#lTop")}))}function c(t){return $("<a>",{class:t.note?"note":"",target:t.target,href:t.href,text:t.text})}function s(t,n){for(var e=t.split("."),i=n.split("."),a=Math.min(e.length,i.length),o=0;o<a;o++){if(Number(i[o])<Number(e[o]))return!1;if(Number(i[o])>Number(e[o]))return!0}return!1}!function n(){$.get("https://steamtraderhelper.com/info/top_link_2.json?version="+a,{},function(t){s(a,t.last_version)?(i=!0,r(t.list_new),e&&o(t.list_new)):e&&r(t.list),i&&(e=!1,setTimeout(n,9e5))},"json")}()}function un(o,t){Zt(null,function(t){for(var n,e=0,i=t.length,a="";e<i;++e)n=t[e],a+=dn(n);o?Xt(o).after(a):$("#Inventars").empty().append(a),o=null})}function ln(R,t,n){function M(t,n){$(t).is(".ch_in_g")&&!$(".ch_in_g:checked").length&&$(t).prop("checked",!0);var e="checkbox"===t.type?t.checked?"1":"":"radio"===t.type?$("[name="+t.name+"]:checked").val():t.value;R("data")[t.id]=n?n(e,t):e}function E(t,n){var e=R("data")[t.id],n=n?n(e,t):e;"checkbox"===t.type?$(t).prop("checked",!!n):"radio"===t.type?$("[name="+t.name+"]"+(n?"[value="+n+"]":":first")).prop("checked",!0):void 0!==n&&$(t).val(n)}function D(t){return parseInt(t)||""}t(n?"widgetOptionsPay":"widgetOptions",{},n?function(){var t=$("#wPageMinQ"),n=$("#wOptQORate"),e=$("#wOptQORateRate"),i=$("#wOptQORateStep"),a=$("#wOptBuyOrderCorrect"),o=$("#wOptBuyOrderCorrectReplase"),r=$("#wOptBuyOrderCorrectReplaseOnlyPlus"),c=$("#wOptBuyOrderCorrectStep"),s=$("#wOptBuyOrderCorrectTop"),u=$("#wOptBuyOrderCorrectDelay"),l=$("#wOptChkClassick"),d=$(".js-optType"),f=$("#wOptBuyOrderCnt"),p=$("#wOptBuyOrderTime"),h=$("#wOptItemInfoTime"),_=$("#wOptRateFilter"),m=$("#wOptIgnoreFraudwarnings"),v=$("#wOptionsChkJSON"),g=$("#wOptionsChkHTML"),y=$(".js-prPrice"),b=$("#wOptionsRate"),k=$("#wOptionsRandomMode"),w=$("#wOptChkSSWhenErr"),C=$("#wOptionsChkRunTime"),x=$("#wOptionsRateRunTime"),S=$("#wOptionsRateStopTime"),T=$("#wOptionsRandomSS"),B=$("PageC,NL,PPrice".split(",").map(function(t){var n="#wOptions";return[n+"Chk"+t,n+"Rate"+t]+""})+"");function O(t){$("body")[t?"addClass":"removeClass"]("sthbA"),c[t?"removeAttr":"attr"]("disabled","")}function A(t){$("body")[t?"addClass":"removeClass"]("sthbAR")}f.change(function(){var t=this.id;setTimeout(function(){$(".js-grp-quantity").attr("placeholder",R("data")[t]||1),t=null},200)}),B.addAll(n,f,p,h,_,s,u,x,S).change(function(){M(this,D)}).each(function(){E(this)}),e.addAll(d,C,a,o,r,l,v,g,y,k,w,T,t,m).change(function(){M(this)}).each(function(){E(this)}),i.add(c).change(function(){M(this,function(t){return isNaN(parseFloat(t))?"":jt(t)+""})}).each(function(){E(this,function(t){return isNaN(parseFloat(t))?"":F(t)+""})}),a.change(function(){O(this.checked)}),O(a.is(":checked")),o.change(function(){A(this.checked)}),A(o.is(":checked")),"PageC,NL,PPrice".split(",").forEach(function(t){function n(t){i[t?"removeAttr":"attr"]("disabled","")}var e="#wOptions",i=$(e+"Rate"+t),e=$(e+"Chk"+t).change(function(){n(this.checked)});n(e.is(":checked"))});function j(){var t=l.is(":checked");$("body")[(t?"remove":"add")+"Class"]("hideClassick")}function I(){var t=L.is(":checked");$(".ss_input")[L.is(":checked")?"removeAttr":"attr"]("disabled",""),$(".ss_input_time")[$("#wOptionsChkRunTime").is(":checked")?"removeAttr":"attr"]("disabled",""),$(".AutoSS")[t?"removeClass":"addClass"]("play_hide")}var P=v.add(g).change(function(t,n){n||this.checked||P.not(this).prop("checked",!0).trigger("change",!0)}),L=(d.change(function(){var t,n,e,i=d.filter(":checked").val();e={1:{add:t="metodDef",rem:(n="metodAuto")+" "+(e="metodQuick")},2:{add:n,rem:t+" "+e},3:{add:e,rem:t+" "+n}}[i||1],$("body").addClass(e.add).removeClass(e.rem)}),v.add(d).trigger("change"),b.change(function(){$(".custom")["C"!==this.value?"attr":"removeAttr"]("disabled","")}).add($(".ch_in_g").first()).trigger("change"),l.change(j),j(),w.add(C));L.change(I),I(),C.change(function(){$(this).is(":checked")&&!R("SS").timeOn&&R("SS").RunTime()})}:function(){function t(){var t=i.is(":checked");$("body")[(t?"remove":"add")+"Class"]("hideClassick")}var n=$("#wPageMinQ"),e=$("#wOptBuyOrderCnt"),i=$("#wOptChkClassick"),a=$("#wOptChkSSWhenErr"),o=$("#wOptionsRate");e.addAll(i,n,a,o).change(function(){M(this)}).each(function(){E(this)});i.change(t),t()})}C(f,function(t){t.detail.STH("isPay")||(on=function(t){var n=30-$(".b_on:checked").size();return!(n<0)&&(Array.isArray(t)?t.slice(0,n):t)})});var dn=function(t){var n=new w($("#item").text()),e=new w($("#coll_SELL_1").text()),i=new w($("#coll_SELL_2").text());return(dn=function(t){t=new Object(t);return t.Budget=t[K]/100,t.BudgetMin=t[X]/100,t.b_chack=t[Z]?"checked":"",!t[s]&&(t[s]=0),t.priseUrl=t[h]&&t[_]?"appid="+t.appid+"&market_hash_name="+t[h]:"",t.item_filterOnOff=function(t){var n="item_filter";return 1==t.buy_type?"":t.filter?n+" item_filter_active":n}(t)+" "+function(t){var n="item_filterFloat";if(1===t.buy_type||730!==t.appid)return"";if(0<t.min_float&&t.min_float<1||0<t.max_float&&t.max_float<1)return n+" item_filterFloat_active";return n}(t),t.urlFull=t[U]+(t[V]?"?filter="+t[V]:""),t.filterName=t[V]||"",t.Receive=F(t[nt]),t.Pays=F(b.getProc(t[nt],t[r])),t.s_chack=t[tt]?"checked":"",t.icon_game=function(t){return en[t]||"/ico/g/default.png"}(t[_]),t.tplSellColl=(localStorage.sellColl?e:i).data({Pays:t.Pays,Receive:t.Receive,id:t.id}),n.data(t)})(t)},w=(C("STH_stop",function(t){$(".js-BuyOrder").each(function(){$(this).removeClass("red").addClass("disabled").find("i").text("—")})}),Class({t:"",f:null,constructor:function(t){this.t=t,this.f=(t.match(/\{\{([\s\S]+?)\}\}/gm)||[]).map(function(t){return{n:(t.match(/\{\{([\s\S]+?)\}\}/)||[]).pop(),m:t}})},data:function(t){for(var n,e=this.f.length,i=this.t;e--;)n=this.f[e],i=i.replace(n.m,t[n.n]);return i}}));function pn(t,n,e){var t=$("#"+t),i=new w(t.is("link")?$("body",t[0].import).html():t.text()),i=$(i.data(n)).insertAfter(t);e&&e.call(i,n)}function C(t,n){return document.addEventListener(t,n,!1)}function x(t,n){t=new CustomEvent(t,{detail:n||{}});document.dispatchEvent(t)}$("#widgetLink").each(function(){var e,i=this,t=i.import,a=$("body",t).html(),o="https://steamtraderhelper.com",r=function(t,n){return t.map?t.length?t.join(n?"":"\n"):"":t},c=function(t,e){return t.map(function(t){var n="boolean"==typeof t.nobr?t.nobr:e||!1;return"string"==typeof t?t:$(t.href?"<a>":"<span>",{target:"_blank",href:o+t.href||"",css:t.cplor?{color:t.cplor}:{}}).text(r(t.text,n)).prop("outerHTML").replace(/([\n])/gi,"<br/>")+(n?"":"<br/>")}).join("")},n=function(){$.get(o+"/user/api/l/",{},function(t){var n;e&&e.remove(),t.bl&&t.bl.map?(e=$("<div>"+t.bl.map(function(t){var n=$(a);return n.find(".title_l").append(c(t.t,!0)),t.a?n.find(".title_r a").text(t.a.text).attr("href",o+t.a.href):n.find(".title_r").remove(),n.find(".body").append(c(t.l,!1)),n.prop("outerHTML")}).join(""))).insertAfter(i):t.t&&((e=$(a)).find(".title_l").text(t.t).attr("href",o+t.th),e.find(".title_r a").text(t.a).attr("href",o+t.ah),t.tc&&e.find(".title_l").css("color",t.tc),t.a||e.find(".title_r"),e.insertAfter(i),n=e.find(".body"),t.ll)&&t.ll.map(function(t){$("<a>",{text:t.text,href:o+t.href,target:"_blank"}).appendTo(n).wrapAll("<p></p>")})},"json"),setTimeout(n,1e5)};n()}),$(j).on("load",function(){$("#chAll").change(function(){var n=this.checked;j.DB.group.getIdsByIndex().then(function(t){x("STH_chk_all",{checked:self.checked}),x(vt,{checked:n,id:t,checkInGroup:!0}),j.DB.item.getIdsByIndex().then(function(t){x(l,{checked:n,id:t,checkInGroup:!0})})})}),$(j.document).on("change",".chkGroup",function(){var a=this;j.DB[H](+a.dataset.id).then(function(t){for(var n=a.checked,e=(x(vt,{checked:a.checked,id:[+a.dataset.id]}),t.length),i=[];e--;)i.push(t[e]);x(l,{checked:n,id:i,checkInGroup:!0})})}),$(j.document).on("change",".item .chkItem",function(t){x(l,{checked:this.checked,id:[+this.dataset.id],checkInGroup:!1})})}),C(vt,function(t){var n=t.detail.id;t.detail.checkInGroup&&Xt(n).find(".chkGroup").prop("checked",t.detail.checked)}),C(l,function(t){t.detail.checkInGroup&&k(t.detail.id).find(".chkItem").prop("checked",t.detail.checked)}),hn={},C(l,function(t){var n=t.detail.id;mn(n,t.detail.checked),t.detail.checkInGroup||O(n),vn(T())}),C($t,function(t){var n=T();t.detail.is_show_check?O($(".chkItem",k(n)).filter(function(){return!this.checked}).prop("checked",!0).map(function(t,n){return+n.dataset.id}).get()):n.length&&(mn(n,!1),O(n),vn([]))}),C(bt,function(){var t=T();mn(t,!1),O(t),vn([])}),C(kt,function(){var t=T();mn(t,!1),O(t),vn([])});var hn,_n,S=T;function T(){return Object.keys(hn).map(function(t){return+t})}function mn(t,n){n?t.forEach(function(t){hn[t]=!0}):t.forEach(function(t){delete hn[t]});var e=T();x(gt,{keys_list:e,id_edit:t,is_checked:n})}function O(t){k(t).filter(function(){return $(this).closest("#Group")}).closest("tbody").each(function(t,n){var e=$(".chkItem",n),i=e.some(function(t){return t.checked}),e=!e.some(function(t){return!t.checked});$(".chkGroup",n)[i?"addClass":"removeClass"]("marked").prop("checked",e)})}function vn(t){t=t.length;$("#chAll")[0<t?"addClass":"removeClass"]("marked")}function gn(e){function t(t,n){clearTimeout(i),i=setTimeout(function(t,n){var t=$(t),e=t.offset(),n=n(t);n?(e.left+=42,o.show().find(".contextMenu_text").html(n),Jt(o,e)):o.hide()},100,t,n)}$(j.document).on("click",".inpLeftTabMarcer,.inpRightTabMarcer",function(){$(this).prev().prev().focus()}),$(j.document).on("mouseover",".item_filter_view",function(){$(this).closest(".item").addClass(this.dataset.c||"filterHover")}).on("mouseout",".item_filter_view",function(){$(this).closest(".item").removeClass(this.dataset.c||"filterHover")});var i,n,a=$("#OBMyItem"),o=$("#OBTabItem"),r=$("#OSMyItem");$(j.document).on("mouseover",".OrderInfo",function(){clearTimeout(i),i=setTimeout(function(t){var t=$(t),n=t.offset(),t=e("B2").order(+t.closest(".item").data("id"));t&&-1!==t?(n.left+=-24,a.show(),Jt(a,n),a.find(".quantity").text(t.count),a.find(".price").text(F(t.price))):a.hide()},100,this)}).on("mouseout",".OrderInfo",function(){clearTimeout(i),a.hide(),o.hide(),r.hide()}),$(j.document).on("mouseover",".SellInfo",function(){clearTimeout(n),n=setTimeout(function(t){var n,t=$(t),i=e("myListings").get("S",t.data("appid"),t.data("hash"));i?(t=t.offset(),n=Object.keys(i).reduce(function(t,n){var n=i[n],e=n.price;return{cnt:t.cnt+n.count,pMin:Math.min(t.pMin||e,e),pMax:Math.max(t.pMax||e,e)}},{cnt:0,pMin:0,pMax:0}),r.show(),Jt(r,t),r.find(".quantity").text(n.cnt),n.pMin===n.pMax?r.find(".price").text(F(n.pMin)):r.find(".price").text(F(n.pMin)+" - "+F(n.pMax))):r.hide()},100,this)}).on("mouseout",".SellInfo",function(){clearTimeout(n),a.hide(),o.hide(),r.hide()}),$(j.document).on("mouseover",".js_SellPrise",function(){t(this,function(t){return e("B2").getPriceSellTab(+t.data("id"))})}).on("mouseover",".js_OrderPrise",function(){t(this,function(t){return e("B2").getPriceBuyTab(+t.data("id"))})}).on("mouseout",".js_OrderPrise,.js_SellPrise",function(){clearTimeout(i),a.hide(),o.hide(),r.hide()}),$(j.document).on("change",".b_Budget",function(t,n){var e;n||(e=(n=$(this)).closest(".item").find(".b_BudgetMin"),(n=n.val())<e.val()&&e.val(n).trigger("change",!0))}).on("change",".b_BudgetMin",function(t,n){var e;n||(e=(n=$(this)).closest(".item").find(".b_Budget"),(n=n.val())>e.val()&&e.val(n).trigger("change",!0))})}(_n=jQuery)(j).on("load",function(){_n("#chDel").click(function(){xt(S())})}),j.$(function(o){function r(){(d?cn:un).apply(null,arguments)}var n,e,t,l=(chrome.extension.getBackgroundPage()||{STH:!1}).STH,d=l("isPay"),i={STH:l,pay:d,show:r};function a(t,n){t.addClass(e),setTimeout(function(t,n){t.removeClass(n)},n,t,e)}d&&Tt(l),d&&o("body").addClass("payShow"),o("title").text("STH v"+l("version")),an("/page/game_icon.json"),an("https://steamtraderhelper.com/game_icon.json"),rn(),sn(),n=l,e="gray",$("#RefreshData").click(function(){var t=$(this);n("start")&&!t.hasClass(e)&&a(t,n("B2").updateInfo()-now())}),0<(t=n("B2").updateInfo(!0)-now())&&a($("#RefreshData"),t),Ot(l,r),gn(l),o(j).on("load",function(){var n,t,e,i;function a(o,n){get("https://steamtraderhelper.com/user/api/importList","json").done(function(a){o&&(a[1]=a[1]||!1,a[2]=a[2]||!1,a[3]=a[3]||!1);var t=Object.keys(a).map(function(t,n){var e={},i=(o&&!a[t]&&(e.color="#666"),{type:"radio",name:"export_radio",value:t});return $("<p>",{css:e}).append($("<i>",{class:"checkbox"}).append($("<input>",i)).append("<i>")).append(" List ",t)});n($("<div>").append(t))})}function c(t){return parseInt(t)||""}function s(t,n){$(t).is(".ch_in_g")&&!$(".ch_in_g:checked").length&&$(t).prop("checked",!0);var e="checkbox"===t.type?t.checked?"1":"":"radio"===t.type?$("[name="+t.name+"]:checked").val():t.value;i("data")[t.id]=n?n(e,t):e}function u(t,n){var e=i("data")[t.id],n=n?n(e,t):e;"checkbox"===t.type?$(t).prop("checked",!!n):"radio"===t.type?$("#"+t.id+(n?"[value="+n+"]":":first")).prop("checked",!0):n&&$(t).val(n)}(t=l().auth())?0<t.subscription?$(".pyInfo.subscription").css("visibility","visible").find(".cnt").text(t.subscription):$(".pyInfo.noSubscription").css("visibility","visible"):$(".pyInfo.noAuth").css("visibility","visible").find(".cnt").text(t.subscription),t&&$("#lSTH").text(t.user).attr("href","https://steamtraderhelper.com/user/profile/"),t=l().authS(),n=l,pn("widgetSteam",t?{href:"https://steamcommunity.com/profiles/"+t.id,name:t.name,isLogin:"yas"}:{href:"https://steamcommunity.com/login/home/",name:"Steamcommunity Login",isLogin:"no"},function(){var t=$(".status",this);setInterval(function(){t.html(n().stimStatus())},3e3)}),d&&(t=l().auth(),e=l,pn("widgetTools",{loadDisabled:t.backap?"":"disabled"},function(){$("#wImport").click(function(){a(!1,function(n){At($("<div>").append("<h2>Load the List").append(n),"Continue","Cancel",function(t){t&&(t=$("input:checked",n).val())&&(y("<h2>Load proccess</h2><p>Loading data from server..."),e().import(t).process(function(t){y("<h2>Load proccess</h2><p>Processing is completed at - "+t+"%")}).end(function(t){j.location.reload()}))})})}),$("#wExport").click(function(){a(!0,function(n){At($("<div>").append("<h2>Save the List").append(n),"Continue","Cancel",function(t){t&&(t=$("input:checked",n).val())&&(y("<h2>Expect...</h2><p>The process of export."),e().export(t).end(function(t){t?j.location.reload():y("<h2>warning</h2><p>export will fail","Ok")}))})})})})),d&&(i=l,pn("widgetOptionsSel",{},function(){var t=$("#wOptSellTime"),n=$("#wOptSellIsAuto"),e=$("#wOptSellCorrectReplase"),i=$("#wOptSellIsAutoVtep"),a=$("#wOptAutoConfirm");function o(t){$("body")[t?"addClass":"removeClass"]("sthsA"),i[t?"removeAttr":"attr"]("disabled","")}function r(t){$("body")[t?"addClass":"removeClass"]("sthsAR")}t.change(function(){s(this,c)}).each(function(){u(this)}),n.add(a).add(e).change(function(){s(this)}).each(function(){u(this)}),i.change(function(){s(this,function(t){return isNaN(parseFloat(t))?"":jt(t)+""})}).each(function(){u(this,function(t){return isNaN(parseFloat(t))?"":F(t)+""})}),n.change(function(){o(this.checked)}),o(n.is(":checked")),e.change(function(){r(this.checked)}),r(e.is(":checked"))})),ln(l,pn,d),St(l),r(0),o("#str").click(function(t,n){var e=l("start");x((e=n?e:l("start",!e))?"STH_start":"STH_stop"),o(this)[(e?"add":"remove")+"Class"]("go")}),l("start")&&o("#str").trigger("click",!0),x(f,{STH:l,show:r}),Bt(l("SS"),o(".AutoSS"),l),$(".doMin").click(function(){$(this).closest('[class*="widget"]').toggleClass("min")})}),setInterval(function(){x("STH_interval",i)},1e4)}),yn=$("<span>"),$n=$("<span>"),bn=$("<span>"),kn=$("<span>"),wn=$("<span>"),Cn=$("<span>"),xn=$("<span>"),Sn=$("<span>"),Tn=$("<span>",{class:"footer_s_rem",text:"X"}),Bn=$("<span>",{class:"footer_s_rem",text:"X"}),On=$("<span>"),An=function(a){var t=" &nbsp;|&nbsp; ";Tn.click(function(){var t,n,e=a("myListings"),i=e().buyorder;if(i)for(t in i)for(n in i[t])e.doBuyRemove(t,n,0)}),Bn.click(function(){var t,n,e=a("myListings")().sell;if(e)for(t in e)for(n in e[t])a("myListings").doSellRemove(t,n,0)}),$("#stat").append([t,$("<span>",{class:"",text:"items: "}).append(yn),t,$("<span>",{class:"footer_b",text:"on: "}).append($n),t,$("<span>",{class:"footer_s pay",text:"on: "}).append(bn),$("<span>",{class:"pay"}).append(t),$("<span>",{class:"footer_b",text:"found: "}).append(kn),t,$("<span>",{class:"footer_b",text:"bought: "}).append(wn),t,$("<span>",{class:"footer_b",text:"orders: "}).append(Cn," (",xn,")").append($("<span>",{class:"footer_s_obl"}).append("[",Tn,"]")),t,$("<span>",{class:"footer_s pay",text:"for sale: "}).append(Sn).append($("<span>",{class:"footer_s_obl"}).append("[",Bn,"]")),$("<span>",{class:"pay"}).append(t),$("<span>",{class:"footer_e",text:"errors: "}).append(On)]),An=function(){}};var yn,$n,bn,kn,wn,Cn,xn,Sn,Tn,Bn,On,An,jn=function(t,n,e,i){if(An(i),n){t;var i=n.c,t=(n.b||0)+(t?"":"/30"),a=e.found,o=e.bought||0,r=e.orders||0,c=e.ordersCnt||0,n=n.s||0,s=e.sall||0,e=e.errors||0;[A(yn,i),A($n,t),A(bn,n),A(kn,a),A(wn,o),A(Cn,r),A(xn,c),A(Sn,s),A(On,e)].forEach(function(t){t.i.text()!==t.v&&t.i.text(t.v)})}else return"..."};function A(t,n){return{i:t,v:n+""}}}(window);