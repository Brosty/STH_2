!function(s){var a=10;function t(){}t.prototype={isBuy:!1,doBuy:function(t){if(this.isBuy||this.isBuyCancel)return!1;this.isBuy=!0,this.get(t)},get:function(t){s.ajax({url:"https://steamcommunity.com/market/createbuyorder/",type:"POST",data:t,crossDomain:!0,xhrFields:{withCredentials:!0}})},end:function(t){this.isBuy=!1},list_buy_orderid:[],done:function(t){29!==t.success&&(1===t.success?(this.list_buy_orderid.push(t.buy_orderid),this.isBuyCancel=!0,s.ajax({url:"https://steamcommunity.com/market/cancelbuyorder/",type:"POST",data:{sessionid:i,buy_orderid:t.buy_orderid}})):console.log(t.success,t.message))},cancelDone:function(t){},cancelEnd:function(t){this.isBuyCancel=!1}};var i,r,o,e,n,c=new t,u=(e=5,n=1,function(){return{sessionid:i,currency:e,appid:o,market_hash_name:r,price_total:+a+5,quantity:n}});d=this,p.prototype={_go:function(){var e=this,t=e.xhr;t.onreadystatechange=function(){var t=this;if(4==t.readyState){if(200==t.status)try{e._done&&e._done("json"==e.t?JSON.parse(t.responseText):t.responseText)}catch(t){}else e._fail&&e._fail(t.status);e._l&&d.STH&&d.STH("SS").Mess(e._l,t.status),e._always&&e._always(),e=e._l=e._done=e._fail=e._always=null}};try{t.send()}catch(t){}},c:function(t){return this},l:function(t){return this._l=t,this},done:function(t){return this._done=t,this},fail:function(t){return this._fail=t,this},always:function(t){return this._always=t,this}};var d,l,m,f,h,y=function(t,e){return new p(t,e)};function p(t,e){var n=this;n.u=t,n.t=e,n.xhr=new XMLHttpRequest,n.xhr.open("GET",n.u,!0),new Date(0).toGMTString(),n.xhr.setRequestHeader("Content-Type","json"==e?"application/json":"application/text"),setTimeout(function(){n._go(),n=null},30)}l=function(){for(var t=document.getElementsByTagName("html"),e=t.length;e--;){var n=t[e].innerHTML;if(n){var a=function(t){var e,n,a,i,r=(t.match(/(?:g_rgAssets[\s]*\=[\s]*)(\{[^\n]+\})(?=;)/)||["{}"]).pop();try{var s=JSON.parse(r)}catch(t){return}if(s){for(e in s)for(a in s[e]){i=s[e][a];break}if(i)for(n in i)return{appid:e,market_hash_name:i[n].market_hash_name}}}(n),a=(i=(n.match(/g_sessionID = "(\w+)";/)||[]).pop(),o=a.appid,r=a.market_hash_name,/ItemActivityTicker\.Start/.test(n)?1:2),n=(n.match(/Market_LoadOrderSpread\( ([0-9]+)/)||[]).pop();if(n)return{item_nameid:n,type:a}}}return null},m=function(e,n,a){var i,r;s("<div>",{text:e.item_nameid,css:{position:"fixed",top:0,left:0,padding:"1em",background:"#fff","z-index":9999999}}).appendTo("body").append(i=s("<input>"),s("<i>",{text:">",css:{display:"inline-block","vertical-align":"middle",width:"2em",height:"1em",background:"red","text-align":"center","border-radius":"1em",padding:".5em",margin:"1em"}}).on("click",function(){var t=s(this);r=t.hasClass("start")?(t.css({background:"#dd0000"}),a(r)):(t.css({background:"#00dd00"}),n(e,function(t){parseFloat(i.val())})),t.toggleClass("start")}))},f=function(t,e){function n(e){var t;a!=e.timestamp&&(t=e.activity)&&t.forEach(function(t){RegExp("выставил этот предмет на продажу").test(e.activity[0])&&r(t)}),a=e.timestamp}var a,i="https://steamcommunity.com/market/itemordersactivity?country=RU&language=russian&currency=5&item_nameid="+t.item_nameid,r=function(t){t=parseFloat(jQuery(t).text().replace(",",".").replace(/.+за ([0-9\.]+).*/,"$1"))||0;t&&e()>t&&c.doBuy(u())};return setInterval(function(){y(i,"json").done(n)},300)},h=function(t){return t.forEach?t.forEach(clearInterval):clearInterval(t)},/\/market\/listings\/[^\/]+\/[^\/]+/.test(location.pathname)&&(ItemActivityTicker&&(ItemActivityTicker.Load=function(){}),Market_LoadOrderSpread=function e(n){$J.ajax({url:"https://steamcommunity.com/market/itemordershistogram",type:"GET",data:{country:g_strCountryCode,language:g_strLanguage,currency:"undefined"!=typeof g_rgWalletInfo&&0!=g_rgWalletInfo.wallet_currency?g_rgWalletInfo.wallet_currency:1,item_nameid:n,two_factor:BIsTwoFactorEnabled()?1:0}}).error(function(){setTimeout(function(){e(n)},5e3)}).success(function(t){setTimeout(function(){e(n)},5e3),1==t.success&&t.highest_buy_order&&0<t.highest_buy_order&&(a=t.highest_buy_order)})},m(l(),f,h))}(jQuery);