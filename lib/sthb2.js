!function(E){"use strict";const R="groupID";const q="b_cnt";const U="b_summ";const F="min_float";var a,N,D,V,G,l,e,s,$,Q,J,W,X,z,K,r,Y,Z,tt,nt,i,u,o,c,et,rt,f,it,at,ut,d,p,m,ot,ct,lt,h,st,_,y,ft,dt,pt,v,mt,ht,_t,yt,vt,St,S,gt,Ot,Tt,bt,Bt,n,g,kt,wt,Ht,It,jt,t;const Ct="name",xt="data";function At(){var t=a.STH("data").wOptBuyOrderCorrectDelay;return 1e3*("number"==typeof t?t:t||0)||0}function Mt(){var t=a.STH("data").wOptBuyOrderCorrectStep;return"number"==typeof t?t:+(t||"1")||0}function O(t){var n=a.STH("data").wOptType;return t?(+n||1)===t:n}function Pt(){return a.STH("isPay")&&O(2)&&a.STH("data").wOptBuyOrderCorrect}function Lt(t,n){a.DB.item.getOne(+t).then(function(t){n(t||null),n=null}).catch(function(){n(null),n=null})}function Et(t){var n,e,r,i,a,u,o,c;t&&((n=t.order())?Pt()&&l("data").wOptBuyOrderCorrectReplase&&(At()&&(o=t,c=s.find(function(t){return t.id===o.id}))&&c.t>now()||(c=n,0!=(n=(u=(n=t)._priceBuyListObj)?(i=n.data,e=c.price,(r=i?i.b_summ:e)<e||(i=i.publisher_fee_percent,i=V(G(e,i),i),c=c.count,a=Mt()+1,(u=$(u,i)).max.some(function(t){return t.price<=r}))||u.is&&u.is.count>c&&Q()&&e<r&&N(r,n.priceBuyObj())>e?1:!l("data").wOptBuyOrderCorrectReplaseOnlyPlus&&!(u.is&&u.is.count>c)&&u.min.length&&0===u.min.filter(function(t){return t.price>=this},i-a).length?2:0):0)?At()&&2==n&&function(t,n){var e=now(),r=s.find(function(t){return t.id===n.id});if(r){if(r.t<e)return void Rt(n)}else s.push({id:n.id,t:e+t});return 1}(At(),t)||(t.setAutoBuyTime(now()),t.doBuy(!0)):Rt(t))):t.count()&&t.doBuy())}function Rt(n){s=s.filter(function(t){return t.id!==n.id})}function qt(){var t=a.STH().authS();t&&K().isPay&&(t=function(){var t=Object.keys(it),n=t.length;if(0<n)return f[t[r=n<=++r?0:r]]}())&&t.scanHtmlPage(function(t,n){n&&n.length&&0<t.data[q]&&a.app.payL(n.map(function(t){return t.id=+this,t},t.id))})}function Ut(t,n){var e=t.data.b_min;(Array.isArray(n)?0<n.filter(function(t){return t.price<=e}).length:t.price()<=e)&&t.doBuyF()}function Ft(e,r,i,n,a){var u,o,c,l,t,s,f,d=i.reduce(Nt,{}),p=STH().auth()||{},m=function(t){return!!t.float&&n<=t.float&&a>=t.float};if(e.data.b_cnt<=0)return r(e,[]);p=p.t,d=d,u="json",t=new XMLHttpRequest,s=JSON.stringify({urls:d}),t.open("POST",nt+p,!0),t.onload=function(){if(200==this.status){if(o)try{var t="json"===u?json_parse(this.responseText):this.responseText;o(t),0}catch(t){c&&c(0)}}else c&&c(this.status);l&&l()},setTimeout(function(){t.send(s),t=null},30),(f={done:function(t){return o=t,f},fail:function(t){return c=t,f},always:function(t){return l=t,f}}).done(function(t){for(var n in t)void 0!==i[n]&&(i[n].float=t[n]);r(e,i.filter(m))}).fail(function(){r(e,[])}).always(function(){r=i=m=e=null})}function Nt(t,n,e){return n.link&&(t[e]=n.link),t}function Dt(){a.DB.gIBIS().then(function(n){var e=Object.keys(f).map(function(t){return parseInt(t)}),t=n.filter(function(t){return-1===e.indexOf(t)}),r=e.filter(function(t){return-1===n.indexOf(t)});t.length&&a.STH("B2").add(t),r.length&&a.STH("B2").remove(r)})}function Vt(t,n){var e,r,i,a=[],u=(c().authS()||{}).TwoFactor,o=!!c("data").wOptIgnoreFraudwarnings;for(r in t)(i=function(t,n){var e=parseInt,r=e(t.converted_price_per_unit),i=e(t.converted_price_per_unit)+e(t.converted_fee_per_unit),a=e(t.converted_fee_per_unit),u=e(t.converted_publisher_fee_per_unit),e=e(t.converted_steam_fee_per_unit);if(a!=u+e||i!=r+u+e)return!1;n&&(i-=e,a-=e);u=null;return t.asset&&730==t.asset.appid&&(u=et(t.asset,t.listingid)),{currencyid:t.converted_currencyid,listingid:t.listingid,subtotal:r,fee:a,total:i,price:i,link:u}}(e=t[r],u))&&i.price&&((e=n[e.asset.appid][e.asset.contextid][e.asset.id]).owner||2!=e.status||!o&&e.fraudwarnings||a.push(Object.assign(i,{quantity:1})));return a}function Gt(t,n){return n=Math.max(1,n||+c("data").wOptBuyOrderCnt),Math.min(t,n)}function $t(n){if(!(!app.isTime()||!n.b_on||n.b_cnt<=0||n.b_summ<=0)){var e;if(Pt()){if(this.testAutoBuyTime&&!this.testAutoBuyTime())return;var t=now();if(!this.updateTime(t-1500*Math.max(Object.keys(i).length,45)))return;e=N(n[U],this.priceBuyObj())}else e=n[U];e<=0||(0!==n[R]?a.DB.group.getOne(n[R]).then(function(t){t=t?t.quantity:0;Qt(n,e,Gt(n[q],t))}):Qt(n,e,Gt(n[q])))}}function Qt(t,n,e){t={i:t.id,appid:t.appid,market_hash_name:t.market_hash_name,price:n,quantity:e},a.app.oPay(t)}function Jt(t){var n;!this._priceBuy||t.b_cnt<=0||t.b_summ<=0||t.b_summ<this._priceBuy||(n=Math.max(c("data").wOptQORateStep||10,1),n=Math.min(t.b_summ,Math.max(t.b_min,this._priceBuy+n)),t={i:t.id,appid:t.appid,market_hash_name:t.market_hash_name,price:n,quantity:1},a.app.oPayF(t))}function Wt(){var t,n=Object.keys(d),e=n.length;0<e&&(n=n[m=e<=++m?0:m],d[n])&&(n=d[e=n].order(),t=p[e],n||t)&&(!t||n&&t===n.id||ot(e),n.id?p[e]=n.id:delete p[e]),m=void 0}function T(){var t=a.STH();t.sall=y+_,t.orders=pt(h.buyorder),t.ordersCnt=v(h.buyorder,1)}function Xt(t,n){return n&&(t[n.appid]||(t[n.appid]={}),t[n.appid][n.market_hash_name]||(t[n.appid][n.market_hash_name]={}),t[n.appid][n.market_hash_name][n.id]=n),t}function zt(t,n){return n&&(t[n.appid]||(t[n.appid]={}),t[n.appid][n.market_hash_name]=n),t}function Kt(t){if(r=t.querySelector("a.market_listing_item_name_link")){var n=mt(r.pathname),e=t.id.replace(/mybuyorder_([0-9]+)/,"$1");if(r=t.querySelector(".market_listing_buyorder_qty .market_listing_price")){var r,i=+r.innerText;if(t.querySelector(".market_listing_inline_buyorder_qty").remove(),r=t.querySelector(".market_listing_my_price:not(.market_listing_buyorder_qty)"))return t=r.innerText.trim(),r=htmlStrToPrice(t),!(!n||!e)&&(n.count=i,n.id=e,n.price=r,n)}}}function Yt(t){var n,e,r,i;return!(!(e=t.querySelector("a.market_listing_item_name_link"))||(e=mt(e.pathname),r=(i=t.querySelectorAll(".market_listing_my_price:not(.market_listing_buyorder_qty) .market_listing_price>span>span"))[0],i=i[1],n=r?(n=r.innerText.trim(),i=i.innerText.trim(),r=htmlStrToPrice(n),htmlStrToPrice(i.replace(/[()]/,""))):r=null,i=t.id.replace(/mylisting_([0-9]+)/,"$1"),!e)||!i)&&(e.subtotal=n,e.price=r,e.count=1,e.id=i,e)}function Zt(t,n,e,r,i){var a=[],u=document.createElement("div");return u.innerHTML=t,u.querySelectorAll(n).forEach(function(t){a.push(e(t))}),u.innerHTML="",a.reduce(r,i||{})}function b(t,n,e,r){return void 0===t?(vt(),h):(ft=r,yt(t,n,e||null))}function tn(){var t=Object.keys(Ot),n=t.length;if(0<n)return gt[t[Tt=n<=++Tt?0:Tt]]}a=E,N=function(n,t){var e;return!Pt()||!Array.isArray(t)||(e=Mt(),0===t.length)||0===(t=t.map(function(t){return{price:t?parseInt(100*t[0]):0,count:t?parseInt(t[1]):0}}).filter(function(t){return(t.price||0)<=n})).length?n:(t=t[0].price,t=Math.max(+t+e,3),Math.min(t,n))},V=function(t,n){return Math.max(t,1)+Math.max(Math.floor(t*(n||10)/100),1)+Math.max(Math.floor(.05*t),1)},D=Math,G=function(t,n){return function t(n,e,r){var i=V(n,r);return e<=n?0:i===e?n:e<i?n-1:t(n+1,e,r)}(D.max(parseInt(t/(105+(n||10))*100),1),t,n)},Q=function(){return Boolean(a.STH("isPay")&&O(2)&&a.STH("data").wOptBuyOrderCorrectTop)},J=function(t,n){var e,r,i=n.reduce(function(t,n){return t[n.price]=(t[n.price]||0)+n.quantity,t},{}),n=Object.keys(i).map(function(t){return[t/100,i[t]]});t._priceSellList=(r='<td align="right">',(e=n).length?'<table class="market_commodity_orders_table"><tr>'+e.map(function(t){return r+t.join(r)}).join("<tr>")+"</table>":""),t._priceSellListObj=n},t=Class({val:0,constructor:function(t,n,e){this.setVal=t,this.minVal=n,this.updateVal=limit(function(){this.val=this.setVal()},3e3)},setVal:function(){return 0},setValueOf:function(n){var e=this.valueOf;return this.valueOf=function(){var t=e.call(this);return n.call(this,t)},this},valueOf:function(){return this.updateVal(),Math.max(+this.val||0,this.minVal||1)}}),W=function(n,e){var t=a.STH().authS(),r=n.data,i=!!r&&r.item_nameid;return t&&i&&(t="https://steamcommunity.com/market/itemordersactivity?country="+t.country+"&language="+t.language+"&currency="+t.currency+"&item_nameid="+i,a.get(t,"json").done(function(t){t=t.activity.filter(function(t){return RegExp("выставил этот предмет на продажу").test(t)}).map(function(t){t=t.replace(/<\/?[^>]+>/g,"").replace(",",".").replace(/.+за ([0-9\.]+).*/,"$1");return 100*parseFloat(t)||0});e(n,t)}).fail(function(t){a.STH().error='STH.GET - Request "itemordersactivity" '+r.item_nameid+" Status Code: "+t}).always(function(t){e=r=null})),n},X=new t(function(){var t=STH("data").wOptItemInfoTime;return STH("isPay")&&t&&1e3*t||5e3},1e3),l=a.STH,e=-1,s=[],$=function(t,e){return t.map(function(t){return{price:t?parseInt(100*t[0]):0,count:t?parseInt(t[1]):0}}).reduce(function(t,n){return n.price===e?t.is=n:n.price>e?t.max.push(n):t.min.unshift(n),t},{min:[],max:[]})},z=function(t){var n;l().isPay&&O(2)&&((t=t||function(){if(At()){var n=now(),t=s.find(function(t){return t.t<n});if(t){if(f[t.id])return f[t.id];Rt(t)}}return null}())?Et(t):0<(n=(t=Object.keys(at)).length)&&Et(f[t[e=n<=++e?0:e]]))},Z=new t(function(){return+a.STH("data").wOptRateFilter||1e4},1e3).setValueOf(function(t){return randProc(t,50)}),K=a.STH,r=-1,new t(function(){return+a.STH("data").wOptQORate},1e3),Y=a.STH,tt=function(t){var n;Y().isPay&&O(3)&&t&&t.data&&!t.data.filter&&(1===(n=t).inOrder()&&n.doBuy(!0),t[t.nextFnScan()](Ut))},nt="http://float.steamtraderhelper.com/?t=",i=f={},u=it={},o=at={},a.DB,c=a.STH,et=function(t,n){if(t&&Array.isArray(t.market_actions))for(var e in t.market_actions){e=t.market_actions[e];if(e&&e.link&&/^steam:\/\//.test(e.link))return e.link.replace("%listingid%",n).replace("%assetid%",t.id)}return null},rt=function(t){return!(!t||730!=t.appid)&&t.max_float<t[F]&&(0<t[F]&&t[F]<1||0<t.max_float&&t.max_float<1)},ut=Class({constructor:function(t){return i[t]||((n=this).id=t,n.data=null,n._price=null,n._priceBuy=null,n._priceBuyList=null,n._priceBuyListObj=null,n._priceSellList=null,n._priceSellListObj=null,n.update(),i[t]=this);var n},doBuy:function(t){var n=this.data;return n&&(t?(t=n,void((n=this.order())&&n.id&&(t={i:t.id,OrderID:n.id,count:n.count},a.app.oClouse(t)))):this.update($t))},doBuyClean:function(t){var n,e=this.data,r=S().buyorder,i=e.appid,e=e.market_hash_name,a=0;return r&&r[i]&&r[i][e]&&(n=r[i][e],t&&n.id!==t||(O(3)&&(a=r[i][e].count),delete r[i][e])),a},_indexFn:0,_time:0,_timeSU:0,nextFnScan:function(){var t,n=this.data,n=n?1===n.buy_type?["scanUrl","scanUrlActivity","scanUrlActivity","scanHtmlPage","scanUrlActivity","scanUrlActivity"]:["scanUrl","scanUrlActivity","scanHtmlPage"]:["scanUrl"],e=n.length;if(0<e)return t=this._indexFn,n[this._indexFn=t=e<=++t?0:t]},doBuyF:function(){this.update(Jt)},doSellRemove:function(){var t=this.id,n=this.data,e=n.appid,n=n.market_hash_name;return S.doSellRemove(e,n,t)},update:function(i){var a=this;return Lt(a.id,function(t){var n,e,r;a.data=t,e=(n=a).data,n=n.id,r=1===e.buy_type?"":e.filter,rt(e)||r?(u[n]=r,delete o[n]):(o[n]=!0,delete u[n]),t||(a.stop(),i=null),i&&i.call(a,a.data),a=i=null},a.id),a},count:function(){var t=this.data;return t?t.b_cnt:0},updateTime:function(t){return!!this._time&&this._time>t},updateTimeSU:function(t){return!!this._timeSU&&this._timeSU>t},price:function(){return this._price},priceBuy:function(){return this._priceBuy||0},priceBuyObj:function(){return this._priceBuyListObj||[]},priceSellTab:function(){return this._priceSellList},priceBuyTab:function(){return this._priceBuyList},remove:function(){var t=this,n=t.id;t.data=t._priceSellList=t._priceSellListObj=t._priceBuyListObj=i[n]=t._priceBuyList=void 0,delete i[n],delete u[n],delete o[n]},order:function(){var t,n=this.data;return n?(t=n.appid,n=n.market_hash_name,S.get("B",t,n)):null},inOrder:function(){var t=this.order();return null===t?-1:t?1:0},sell:function(){var t,n,e=this.data;return e?(t=S().sell,n=e.appid,e=e.market_hash_name,!!(t&&t[n]&&t[n][e])&&t[n][e]):null},inSell:function(){var t=this.sell();return null===t?-1:t?1:0},scanHtmlPage:function(i){var t=c().authS(),a=this,n=a.data;c("SS").page&&t&&n&&n.item_nameid&&!a.get&&(a.get=get(n.url+(n.filter?"?filter="+n.filter:"")).done(function(t){if(a.data){var n=(t.match(/(?:g_rgListingInfo[\s]*\=[\s]*)(\{[^;]+\})/g)||[]).pop(),t=(t.match(/(?:g_rgAssets[\s]*\=[\s]*)(\{[^\n]+\};)/g)||[]).pop();if(n&&t){try{r=json_parse(n.replace(/(?:g_rgListingInfo[\s]*\=[\s]*)(\{[^;]+\})/g,"$1"))||{},e=json_parse(t.replace(/(?:g_rgAssets[\s]*\=[\s]*)(\{[^\n]+\});{0,1}/g,"$1"))||{}}catch(t){return}var e,n=+a.data.b_summ,t=Vt(r,e),r=(a.data.filter&&J(a,t),a._price=t.map(function(t){return t.price}).reduce(function(t,n){return Math.min(t||n,n)},0)||0);i&&(n<r?i(a,[]):(e=t.filter(function(t){return t.price<=this},n).sort(function(t,n){if(t){if("MAX"==n)return function(t,n){return t.price<n.price?1:-1};if("RND"==n)return function(){return.5-Math.random()}}return function(t,n){return t.price>n.price?1:-1}}(c("isPay"),c("data").wOptionsRadPP)),rt(a.data)?Ft(a,i,e,a.data.max_float,a.data.min_float):i(a,e)))}}}).fail(function(t){c().error="STHB-2 - Recuest status:"+t}).always(function(){a.get=null,a=i=null}).l("page"))},scanUrl:function(n){var t,e,r=c().authS(),i=this;if(!i.updateTimeSU(now()-1e3))return t=i.data,c("SS").ordershistogram&&r&&t&&t.item_nameid&&(e=r.TwoFactor?0:1,i._timeSU=now(),a.app.tabGetPrice({country:r.country,language:r.language,currency:r.currency,item_nameid:t.item_nameid,two_factor:e},function(t){i._timeSU=now(),i._time=now(),i._priceBuy=+t.highest_buy_order||0,i._price=+t.lowest_sell_order||0,i._priceSellList=t.sell_order_table,i._priceSellListObj=t.sell_order_graph,i._priceBuyList=void 0,i._priceBuyList=t.buy_order_table,i._priceBuyListObj=t.buy_order_graph,n&&n(i),z(i)})),t=null,i},scanUrlActivity:function(t){return W(this,t)},__autoBuyTime:0,setAutoBuyTime:function(t){this.__autoBuyTime=t},testAutoBuyTime:function(){return 9e3<now()-this.__autoBuyTime}}),d=f,p={},m=-1,ot=function(t){mp3()},Wt.remove=function(t,n){p[t]===n&&delete p[t]},ct=Wt,S=a.STH("myListings",(lt="https://steamcommunity.com/market/mylistings",h={},y=_=0,ft=100,dt=new t(function(){return a.STH("isPay")?6e4*Math.max(+a.STH("data").wOptBuyOrderTime||5,1):3e5},1e4),pt=function(e){return e?Object.keys(e).reduce(function(t,n){return t+Object.keys(e[n]).length},0):0},v=function(e,t){var r=t-1;return e?Object.keys(e).reduce(0<t?function(t,n){return t+v(e[n],r)}:function(t,n){return t+(e[n].count||0)},0):0},ht=0,_t=!(mt=function(t){t=decodeURIComponent(t.replace(/\/market\/listings\/([0-9]+)\/(.+)/,"$1\n$2")).split("\n");return!(2!==t.length||!t[0]||!t[1])&&{appid:t[0],market_hash_name:t[1]}}),yt=function(t,n,e){ht=now(),n&&(_=0,h.S=null,h={}),h.sell=Zt(t,"div[id^=mylisting_]",Yt,Xt,h.sell),h.buyorder=Zt(t,"div[id^=mybuyorder_]",Kt,zt,h.buyorder),null!==e?(y=e,(n=v(h.sell,2)+_)<y&&get(lt+"/render/?query=&start="+n+"&count="+ft,"json").done(function(t){t.success&&t.results_html&&(yt(t.results_html,!1,t.total_count),t.success=t.results_html=t.total_count=null)}).fail(function(t){a.STH().error='STH.GET - Request "mylistings/render" Status Code: '+t}).always(function(){})):y=v(h.sell,2),T()},vt=limit(function(){_t||+dt+ht>now()||st||(_t=!0,st=get(lt,"json").done(function(t){t.success&&yt(t.results_html,!0,t.total_count)}).fail(function(t){a.STH().error='STH.GET - Request "mylistings" Status Code: '+t}).always(function(){st=null,_t=!1}))},1e4),b.get=function(t,n,e){vt();t=h["S"===t?"sell":"buyorder"];return!!(t&&t[n]&&t[n][e])&&t[n][e]},b.getSellPriseMin=function(t,n){var e=b.get("S",t,n),r=Object.keys(e).map(function(t){return e[t].price}),t=t+"_"+n,n=h._S&&h._S[t]?h._S[t]:[];return Math.min.apply(0,r.concat(n))},b.addSell=function(t,n){Lt(t,function(t){t&&(t=t.appid+"_"+t.market_hash_name,h._S||(h._S={}),h._S[t]||(h._S[t]=[]),h._S[t].push((t=n,Math.max(t,1)+Math.max(Math.floor(.1*t),1)+Math.max(Math.floor(.05*t),1))),_++,T(),n=null)})},b.addOrder=function(t,n,e,r){Lt(t,function(t){t&&(h.buyorder||(h.buyorder={}),zt(h.buyorder,{id:n,price:e,count:r,appid:t.appid,market_hash_name:t.market_hash_name}),T())})},St=0,b.updateInfo=function(t){var n=now();return t||n<St?St:(ht=0,St=n+6e4)},b.doBuyRemove=function(t,n,e){var r=h.buyorder,r=!!(r&&r[t]&&r[t][n])&&r[t][n];r&&(e={i:e,OrderID:r.id,count:r.count,appID:t,hashName:n},a.app.oClouse(e))},b.doSellRemove=function(t,n,e){var r=b.get("S",t,n);r&&b.doSellItemsRemove(t,n,e,Object.keys(r))},b.doSellItemsRemove=function(t,n,e,r){r&&r.length&&a.app.oSR({i:e,sellIds:r,appID:t,hashName:n}),T()},b.remove=function(t,n,e,r){var i=h[~["S","S2"].indexOf(t)?"sell":"buyorder"],i=i?i[n]:null,a=i?i[e]:null;a&&("S2"===t?(r.forEach(function(t){delete a[t]}),Object.keys(a).length||delete i[e]):"S"===t&&(delete a[r],Object.keys(a).length)||delete i[e],T())},b.getCntB=function(t,n,e){},b)),bt=new t(function(){return a.STH("isPay")?O(3)?Math.max(+a.STH("data").wOptQORate,1200):+X||1200:5e3}),gt=f,Ot=at,Tt=-1,Bt=function(){var t;O(3)?tt(tn()):(t=tn())&&t.scanUrl()},a.STH("B2",(g=f,(n={}).add=function t(n){n&&(n.forEach?n.forEach(t):new ut(n))},n.remove=function t(n){n&&(n.forEach?n.forEach(t):g[n]&&g[n].remove())},n.getCnt=function(t){return g[t]?parseInt(g[t].count()):null},n.getPrice=function(t){return g[t]?g[t].price():0},n.getPriceBuy=function(t){return g[t]?g[t].priceBuy():0},n.getPriceBuyTab=function(t){return g[t]?g[t].priceBuyTab():""},n.getPriceSellTab=function(t){return g[t]?g[t].priceSellTab():""},n.order=function(t){return g[t]?g[t].order():-1},n.inOrder=function(t){return g[t]?g[t].inOrder():-1},n.doBuy=function(t,n){return!g[t]||g[t].doBuy(n)},n.doBuyClean=function(t,r,i){g[t]&&(g[t]._time=0),ct.remove(t,r),Lt(t,function(t){var n=t.appid,t=t.market_hash_name,e=S.get("B",n,t),e=O(3)||!e||r&&e.id!==r?0:e.count;S.remove("B",n,t),i(e),i=null})},n.inSell=function(t){return!g[t]||g[t].inSell()},n.doSellRemove=function(t){return!g[t]||g[t].doSellRemove()},n.stop=function(){clearInterval(kt),clearInterval(wt),Object.keys(g).forEach(function(t){n.remove(t)}),clearMyInterval(Ht),clearMyInterval(It),clearMyInterval(jt)},n.start=function(){kt=setInterval(function(){Dt()},3e3),wt=setInterval(function(){ct()},3e3),Ht=myInterval(function(){Bt()},bt),It=myInterval(z,X),jt=myInterval(qt,Z),Dt()},n.update=function e(t){a.STH("start")&&("function"==typeof t.forEach?t.forEach(function(t,n){setTimeout(e,+n,t)}):g[t]&&g[t].update())},n.updateInfo=function(t){return S.updateInfo(t)},n));var B=E;k={},en.setOn=function(t,n){return k[t]||(k[t]=[]),k[t].push(n),en};var k,w,nn=en;function en(t){var n,e;t.do&&(n=t.do,e=t,Array.isArray(k[n]))&&k[n].forEach(function(t){t(e)})}function rn(t,n,e,r){var i=M();i?(w=r,P(i,{on:"auth",login:t,pass:n,twoFactorCode:e})):r(1)}function an(t,n,e,r){var i=M();i?P(i,{on:"auth",login:t,pass:n,authCode:e}):r(1)}function un(t,n,e,r){var i=M();w=r,i?P(i,{on:"authMobale",login:t,pass:n,sms:e}):r(1)}function on(t,n,e,r){var i=M();w=r,i?P(i,{on:"aSms",login:t,type:n,sms:e}):r(1)}function cn(t,n,e){var r=M();r?(w=e,P(r,{on:"reauth",login:t,pass:n})):e(1)}function ln(t,n){var e=M();e?(w=n,P(e,{on:"authCode",code:t})):n(1)}nn.setOn("err",function(t){"Not Logged In"===t.err&&(x=null)}).setOn("errAuth",function(t){w&&w(t.err,t)}).setOn("errAuth2",function(t){w&&w(t.err,t)}).setOn("codeAuth",function(t){w&&w(null,"aC",t)}).setOn("sms",function(t){j.on("smsForm",[t])}).setOn("s",function(t){t.err?w&&w(t.err,t):Bn(t.login,t.data||"",t.r||"",function(t,n){t||L(n),w&&w(t,n)})}).setOn("confirmations",function(t){t=mn.parse(t.confirmations||[]);j.on("confirmations",[t])}).setOn("confirmations_r",function(t){mn.parse_r(t.err,t.id||0),j.on("confirmations_r",[t.err,t.id])}).setOn("showFn",function(t){j.on("showFn")}).setOn("authCode",function(t){j.on("authCode",[t.text,x])}).setOn("err",function(t){j.on("err",[t])}).setOn("reAuth",function(t){j.on("reAuth",[t])}),fn=1e3,dn=0,H=[];var sn,fn,dn,H,pn,mn={parse:function(t){var n,e=/^(Продажа|Sell|Продаване|Vender|Eladás|Πώληση|Sælg|Vendi|出售|판매|Verkaufen|Verkopen|Selg|Sprzedaj|Vinde|ขาย|Sat|Продати|Myy|Vendre|Prodat|Sälj|売却) /;return H=[],yn()&&Array.isArray(t)?(pn={},H=(n=t).filter(i),function t(){H&&H.length&&(hn(H.pop()),setTimeout(function(){t()},fn))}(),n.filter(r)):t;function r(t){return t.title&&!e.test(t.title)}function i(t){return t.title&&e.test(t.title)}},parse_r:function(t,n){},start:function(){sn=setInterval(_n,6e4),_n()},stop:function(){H=[],clearInterval(sn||null)}};function hn(t){vn(t.id,t.key,!0),pn[t.id]={id:t.id,key:t.key,t:now()}}function _n(t){if(yn()){if(0<dn)return--dn;Sn()&&Tn(function(t){t?101===t&&(dn+=5):L(parseInt(localStorage.SellAcc)||0,function(){})})}}function yn(){return B.STH("isPay")&&B.STH("start")&&STH("data").wOptAutoConfirm}function vn(t,n,e){return A?C?(P(C,{on:"confirmations",id:t,key:n,accept:e}),null):2:1}var I,j={set:function(t){I=t},on:function(t,n){I&&I[t]&&I[t].apply(I,((t=n)?Array.isArray(t)?t:[t]:[])||[])}};function Sn(){return bn(C)||(P(C,{on:"getConfirmation"}),null)}function gn(){return bn(C)||(P(C,{on:"getSG"}),null)}function On(i,t){var a=i.length;function u(){t(),t=null}!function t(n){function e(){t(n+1),n=null}{var r;n<a?(r=i[n]).name?Bn(r.name,r.data||"",r.recovery||"",function(){e()}):e():u()}}(0)}var C,x,A=!(pn={}),Tn=function(t,n){return A&&C&&(C.readyState===C.OPEN||C.readyState===C.CONNECTING)?(t(null,C),C):C&&C.readyState===C.CLOSING?void setTimeout(function(){Tn(t,n)},200):(x=null,C=function(r,t){var n=STH().auth();if(!n)return r(1),r=null;try{var e=new WebSocket("ws://185.41.163.123:3000/?"+function(n){return Object.keys(n).map(function(t){return t+"="+encodeURIComponent(n[t])}).join("&")}({necessarily:t?"1":"0",user:n.user,t:n.t}))}catch(t){return r(2),r=null}t="addEventListener";return e[t]("open",function(){A=!0}),e[t]("message",function(t){var n=t.data;if("open"==n)r&&r(null,t),r=null;else if(n&&"{"===n[0])try{var e=json_parse(n);"error"==e.do?(r&&r(e.numm),1===e.err_a&&nn(e),r=null):nn(e)}catch(t){STH.error="Error: mess "+t}}),e[t]("close",function(t){var n;x=null,t.wasClean?(n=(t.code||0)-4e3,j.on("close",[n]),r&&r(n)):STH.error="Error: code "+t.code+" - "+t.reason,L.clear(),r=C=e=null,A=!1}),e[t]("error",function(t){STH.error="Error: "+t.message}),e}(t,n))};function M(){return A&&C?C:null}function bn(t){return A?t?t.readyState!==WebSocket.OPEN?3:null:2:1}function Bn(n,e,r,i){function a(){return{name:n||"",recovery:r||"",data:e||""}}function u(t){i(t?null:200,t),n=e=r=i=null,L(t,function(t){})}B.DB.gAN(n).then(function(t){var n;(t?(n=t.id,B.DB.accounts.up(n,a()).then(function(){u(n),n=null})):B.DB.accounts.set(a()).then(function(t){u(t)})).catch(function(){u(null)})})}function P(t,n){t&&(t.readyState===t.CONNECTING?setTimeout(function(){P(t,n),t=null},100):t.readyState===t.OPEN&&t.send&&t.send("string"==typeof n?n:JSON.stringify(n)))}Hn.clear=function(){x=kn=wn=null};var kn,wn,L=Hn;function Hn(r,t,n){var e,i=t||function(){},a=void 0===n?x===r:n;function u(t,n,e){var r;e?i(null,{},t):(e=t,t=n,r=function(t,n){i(t,n)},(n=M())?(w=function(t,n){r(t,n)},P(n,{on:"a2",login:e,data:t})):r(1))}x===r?u(kn,wn,a):(e=function(t,n,e){t?i(t):(localStorage.SellAcc=r,x=r,u(kn=n,wn=e,a))},B.DB.accounts.getOne(r).then(function(t){t?e(null,t[Ct],t[xt]):e(1)}).catch(function(){e(1)}).finally(function(){e=null}))}B.STH("ACT",((t={}).start=mn.start,t.stop=mn.stop,t.setForm=j.set,t.insert=On,t.open=function(t){Tn(t)},t.openC=function(t){Tn(t,!0)},t.setId=L,t.getSG=gn,t.getConf=Sn,t.doConf=vn,t.getIsOpen=function(){return A},t.new=rn,t.aC=ln,t.aG=an,t.reauth=cn,t.authMobale=un,t.aSms=on,t))}(window);